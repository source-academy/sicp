<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <!-- Global site tag (gtag.js) - Google Analytics - START -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-156801664-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-156801664-1');
    </script>
    <!-- Global site tag (gtag.js) - Google Analytics - END -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="description" content="5.5.5&nbsp;&nbsp;
    An Example of Compiled Code
   - SICP Comparison Edition" />
    <title>
      5.5.5&nbsp;&nbsp;
    An Example of Compiled Code
   - SICP Comparison Edition
    </title>
    
  <meta name="csrf-param" content="authenticity_token" />
  <meta name="csrf-token" content="EMTEijVc2kiiKUH4nYH0lQG3pLPfMowQ/Stg//t6DCo0e5pWMQwamnTvIdmVZqY/MqSx2IYYE+2bpNV6UNSMwQ==" />

    <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata&display?swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Droid+Sans|Droid+Serif" rel="stylesheet">
    <link rel="stylesheet" media="all" href="../assets/stylesheet.css" />

   <link rel="shortcut icon" type="image/x-icon" href="../assets/sourcepower.ico" />

<!--    <link rel="shortcut icon" type="image/png" href="../images/lambda.png" /> -->

    <!-- for support of progressive web app, see github README, DISABLED!
    <link rel="manifest" href="../static/manifest.json">
    -->

    <script src="https://code.jquery.com/jquery-3.2.1.min.js" 
		     	  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
	          crossorigin="anonymous">
    </script> 

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

    <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script> -->
    <script type="text/javascript" 
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-AMS-MML_HTMLorMML-full">
    </script>
   <!--  <script type="text/javascript" 
      src="../MathJax/MathJax.js?config=TeX-AMS-MML_HTMLorMML-full">
    </script> -->
  
    <script src="../assets/application.js"></script>
  
    <!-- Rendering inline LaTeX -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true,
          jax: ["input/TeX","output/HTML-CSS"]
        }
      });
    </script>
    <!--<script src="/mathjax/MathJax.js?config=TeX-AMS_HTML-full.js" type="text/javascript"></script>-->
    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js" type="text/javascript"></script>
    <![endif]-->
  </head>
  <body>

    
    <!-- support for progressive web app, see README, DISABLED
    <script>
      if ('serviceWorker' in navigator && !navigator.serviceWorker.controller) {
          navigator.serviceWorker.register("../sw.js").then(function(reg) {
              console.log("Service worker has been registered for scope: " + reg.scope);
          });
      }
    </script>
    -->

     <nav class="navbar navbar-expand-sm navbar-dark bg-dark fixed-top justify-content-between">
       <button id="btn" class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#nav-sidebar" aria-controls="nav-sidebar" aria-expanded="false" aria-label="Toggle navigation" title="navigation">
         <span class="navbar-toggler-icon"></span>
       </button>
       <span class="toolt">Legend<span class="toolttext">
    <div class="title-text-ALSO">
      <span class="title-text-ALSO">Color highlighting:</span><BR/>
    </div>
    <div class="title-text-OTHEREDITIONS">
      <span class="title-text-OTHEREDITIONS">
      <span style="color:black">Unchanged █</span>
      </span>
    </div>
    <div class="title-text-OTHEREDITIONS">
      <span class="title-text-OTHEREDITIONS">
      <span style="color:green">Scheme █</span>
      </span>
    </div>
    <div class="title-text-OTHEREDITIONS">
      <span class="title-text-OTHEREDITIONS">
      <span style="color:blue">Javascript █</span>
      </span>
    </div>
    <div class="title-text-OTHEREDITIONS">
      <span class="title-text-OTHEREDITIONS">
      <span style="color:grey">Explanation █</span>
      </span>
    </div>
    <div class="title-text-OTHEREDITIONS">
      <span class="title-text-OTHEREDITIONS">
      <span style="color:red">Web-only █</span>
    </div>
</span></span>
       <span class="navbar-brand-short"><a title="Go back to front page" href="../index.html" class="gray">SICP &mdash; Scheme/JS</a></span>
       <span class="navbar-brand-long" ><a title="Go back to front page" href="../index.html" class="gray">Structure and Interpretation of Computer Programs &mdash; Comparison Edition</a></span>

     </nav>
     
     <div class="container scroll">

     
        <div class="collapse" id="nav-sidebar" role="tablist" aria-multiselectable="true">
        <!-- insert a dummy entry, to give one extra line of space -->
        <a class="navbar-brand" href="index.html">&nbsp;</a>
    
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-1">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-1" aria-expanded="false" aria-controls="sidebar-collapse-1">
                <a href="./foreword02.html"> 
        <span style="color:blue">Foreword</span>
    </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-2">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-2" aria-expanded="false" aria-controls="sidebar-collapse-2">
                <a href="./foreword84.html"> Foreword <span style="color:blue">to Structure and Interpretation of Computer Programs, 1984</span></a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-3">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-3" aria-expanded="false" aria-controls="sidebar-collapse-3">
                <a href="./prefaces03.html"> 
    
      <span style="color:blue">Preface</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-4">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-4" aria-expanded="false" aria-controls="sidebar-collapse-4">
                <a href="./prefaces96.html"> 
    Prefaces
    
      <span style="color:blue">
	to Structure and Interpretation of Computer Programs, 1996<span style='color:blue'> & </span>1984
      </span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-5">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-5" aria-expanded="false" aria-controls="sidebar-collapse-5">
                <a href="./acknowledgements.html"> Acknowledgments</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-6">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-6" aria-expanded="false" aria-controls="sidebar-collapse-6">
                <a href="./see.html"> </a>
              </span>
            </h5>
          </div>
        </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-7">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-7" aria-expanded="true" aria-controls="sidebar-collapse-7">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-7" aria-expanded="true" aria-controls="sidebar-collapse-7">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./1.html">1 
    Building Abstractions with 
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
  </a>
                </h5>
              </div>

              <div id="sidebar-collapse-7" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-8">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-8" aria-expanded="true" aria-controls="sidebar-collapse-8">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-8" aria-expanded="true" aria-controls="sidebar-collapse-8">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./1.1.html">1.1 The Elements of Programming</a>
                </h5>
              </div>

              <div id="sidebar-collapse-8" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-9">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-9" aria-expanded="false" aria-controls="sidebar-collapse-9">
                <a href="./1.1.1.html"> 1.1.1 Expressions</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-10">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-10" aria-expanded="false" aria-controls="sidebar-collapse-10">
                <a href="./1.1.2.html"> 1.1.2 Naming and the Environment</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-11">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-11" aria-expanded="false" aria-controls="sidebar-collapse-11">
                <a href="./1.1.3.html"> 1.1.3 
    Evaluating
    
      <span style="color:green">Combinations</span>
      <span style="color:blue">Operator Combinations</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-12">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-12" aria-expanded="false" aria-controls="sidebar-collapse-12">
                <a href="./1.1.4.html"> 1.1.4 
    Compound <span style="color:green">Procedures</span>
    <span style="color:blue">Functions</span>
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-13">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-13" aria-expanded="false" aria-controls="sidebar-collapse-13">
                <a href="./1.1.5.html"> 1.1.5 
    The Substitution Model for 
    
      <span style="color:green">
        Procedure
      </span>
      <span style="color:blue">
        Function
      </span>
    
    Application
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-14">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-14" aria-expanded="false" aria-controls="sidebar-collapse-14">
                <a href="./1.1.6.html"> 1.1.6 
    Conditional Expressions and Predicates
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-15">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-15" aria-expanded="false" aria-controls="sidebar-collapse-15">
                <a href="./1.1.7.html"> 1.1.7 Example: Square Roots by Newton's Method</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-16">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-16" aria-expanded="false" aria-controls="sidebar-collapse-16">
                <a href="./1.1.8.html"> 1.1.8 
    
      <span style="color:green">
        Procedures
      </span>
      <span style="color:blue">
        Functions
      </span>
    
    as Black-Box Abstractions
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-17">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-17" aria-expanded="true" aria-controls="sidebar-collapse-17">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-17" aria-expanded="true" aria-controls="sidebar-collapse-17">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./1.2.html">1.2 
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
    and the Processes They Generate
  </a>
                </h5>
              </div>

              <div id="sidebar-collapse-17" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-18">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-18" aria-expanded="false" aria-controls="sidebar-collapse-18">
                <a href="./1.2.1.html"> 1.2.1 Linear Recursion and Iteration</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-19">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-19" aria-expanded="false" aria-controls="sidebar-collapse-19">
                <a href="./1.2.2.html"> 1.2.2 Tree Recursion</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-20">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-20" aria-expanded="false" aria-controls="sidebar-collapse-20">
                <a href="./1.2.3.html"> 1.2.3 Orders of Growth</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-21">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-21" aria-expanded="false" aria-controls="sidebar-collapse-21">
                <a href="./1.2.4.html"> 1.2.4 Exponentiation</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-22">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-22" aria-expanded="false" aria-controls="sidebar-collapse-22">
                <a href="./1.2.5.html"> 1.2.5 Greatest Common Divisors</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-23">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-23" aria-expanded="false" aria-controls="sidebar-collapse-23">
                <a href="./1.2.6.html"> 1.2.6 Example: Testing for Primality</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-24">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-24" aria-expanded="true" aria-controls="sidebar-collapse-24">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-24" aria-expanded="true" aria-controls="sidebar-collapse-24">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./1.3.html">1.3 
        Formulating Abstractions with Higher-Order 
        
	  <span style="color:green">Procedures</span>
	  <span style="color:blue">Functions</span>
	
      </a>
                </h5>
              </div>

              <div id="sidebar-collapse-24" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-25">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-25" aria-expanded="false" aria-controls="sidebar-collapse-25">
                <a href="./1.3.1.html"> 1.3.1 
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
    as Arguments
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-26">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-26" aria-expanded="false" aria-controls="sidebar-collapse-26">
                <a href="./1.3.2.html"> 1.3.2 
    
      <span style="color:green">Constructing Procedures using Lambda</span>
      <span style="color:blue">Constructing Functions using Lambda Expressions
      </span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-27">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-27" aria-expanded="false" aria-controls="sidebar-collapse-27">
                <a href="./1.3.3.html"> 1.3.3 
    
      <span style="color:green">Procedures</span>
    <span style="color:blue">Functions</span>
    as General Methods
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-28">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-28" aria-expanded="false" aria-controls="sidebar-collapse-28">
                <a href="./1.3.4.html"> 1.3.4 
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
    as Returned Values
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-29">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-29" aria-expanded="true" aria-controls="sidebar-collapse-29">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-29" aria-expanded="true" aria-controls="sidebar-collapse-29">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.html">2 Building Abstractions with Data</a>
                </h5>
              </div>

              <div id="sidebar-collapse-29" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-30">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-30" aria-expanded="true" aria-controls="sidebar-collapse-30">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-30" aria-expanded="true" aria-controls="sidebar-collapse-30">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.1.html">2.1 Introduction to Data Abstraction</a>
                </h5>
              </div>

              <div id="sidebar-collapse-30" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-31">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-31" aria-expanded="false" aria-controls="sidebar-collapse-31">
                <a href="./2.1.1.html"> 2.1.1 
    Example: Arithmetic Operations for Rational Numbers
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-32">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-32" aria-expanded="false" aria-controls="sidebar-collapse-32">
                <a href="./2.1.2.html"> 2.1.2 
    Abstraction Barriers
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-33">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-33" aria-expanded="false" aria-controls="sidebar-collapse-33">
                <a href="./2.1.3.html"> 2.1.3 
    What Is Meant by Data?
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-34">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-34" aria-expanded="false" aria-controls="sidebar-collapse-34">
                <a href="./2.1.4.html"> 2.1.4 
    Extended Exercise: Interval Arithmetic
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-35">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-35" aria-expanded="true" aria-controls="sidebar-collapse-35">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-35" aria-expanded="true" aria-controls="sidebar-collapse-35">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.2.html">2.2 Hierarchical Data and the Closure Property</a>
                </h5>
              </div>

              <div id="sidebar-collapse-35" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-36">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-36" aria-expanded="false" aria-controls="sidebar-collapse-36">
                <a href="./2.2.1.html"> 2.2.1 
    Representing Sequences
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-37">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-37" aria-expanded="false" aria-controls="sidebar-collapse-37">
                <a href="./2.2.2.html"> 2.2.2 
    Hierarchical Structures
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-38">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-38" aria-expanded="false" aria-controls="sidebar-collapse-38">
                <a href="./2.2.3.html"> 2.2.3 
    Sequences as Conventional Interfaces
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-39">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-39" aria-expanded="false" aria-controls="sidebar-collapse-39">
                <a href="./2.2.4.html"> 2.2.4 
    Example: A Picture Language
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-40">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-40" aria-expanded="true" aria-controls="sidebar-collapse-40">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-40" aria-expanded="true" aria-controls="sidebar-collapse-40">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.3.html">2.3 Symbolic Data</a>
                </h5>
              </div>

              <div id="sidebar-collapse-40" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-41">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-41" aria-expanded="false" aria-controls="sidebar-collapse-41">
                <a href="./2.3.1.html"> 2.3.1 
    
      <span style="color:green">Quotation</span>
      <span style="color:blue">Strings</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-42">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-42" aria-expanded="false" aria-controls="sidebar-collapse-42">
                <a href="./2.3.2.html"> 2.3.2 
    Example: Symbolic Differentiation
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-43">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-43" aria-expanded="false" aria-controls="sidebar-collapse-43">
                <a href="./2.3.3.html"> 2.3.3 
    Example: Representing Sets
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-44">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-44" aria-expanded="false" aria-controls="sidebar-collapse-44">
                <a href="./2.3.4.html"> 2.3.4 
    Example: Huffman Encoding Trees
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-45">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-45" aria-expanded="true" aria-controls="sidebar-collapse-45">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-45" aria-expanded="true" aria-controls="sidebar-collapse-45">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.4.html">2.4 Multiple Representations for Abstract Data</a>
                </h5>
              </div>

              <div id="sidebar-collapse-45" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-46">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-46" aria-expanded="false" aria-controls="sidebar-collapse-46">
                <a href="./2.4.1.html"> 2.4.1 
    Representations for Complex Numbers
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-47">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-47" aria-expanded="false" aria-controls="sidebar-collapse-47">
                <a href="./2.4.2.html"> 2.4.2 
    Tagged data
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-48">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-48" aria-expanded="false" aria-controls="sidebar-collapse-48">
                <a href="./2.4.3.html"> 2.4.3 
    Data-Directed Programming and Additivity
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-49">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-49" aria-expanded="true" aria-controls="sidebar-collapse-49">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-49" aria-expanded="true" aria-controls="sidebar-collapse-49">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.5.html">2.5 Systems with Generic Operations</a>
                </h5>
              </div>

              <div id="sidebar-collapse-49" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-50">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-50" aria-expanded="false" aria-controls="sidebar-collapse-50">
                <a href="./2.5.1.html"> 2.5.1 
    Generic Arithmetic Operations
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-51">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-51" aria-expanded="false" aria-controls="sidebar-collapse-51">
                <a href="./2.5.2.html"> 2.5.2 
    Combining Data of Different Types
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-52">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-52" aria-expanded="false" aria-controls="sidebar-collapse-52">
                <a href="./2.5.3.html"> 2.5.3 
    Example: Symbolic Algebra
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-53">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-53" aria-expanded="true" aria-controls="sidebar-collapse-53">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-53" aria-expanded="true" aria-controls="sidebar-collapse-53">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.html">3 Modularity, Objects, and State</a>
                </h5>
              </div>

              <div id="sidebar-collapse-53" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-54">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-54" aria-expanded="true" aria-controls="sidebar-collapse-54">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-54" aria-expanded="true" aria-controls="sidebar-collapse-54">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.1.html">3.1 Assignment and Local State</a>
                </h5>
              </div>

              <div id="sidebar-collapse-54" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-55">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-55" aria-expanded="false" aria-controls="sidebar-collapse-55">
                <a href="./3.1.1.html"> 3.1.1 
    Local State Variables
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-56">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-56" aria-expanded="false" aria-controls="sidebar-collapse-56">
                <a href="./3.1.2.html"> 3.1.2 
    The Benefits of Introducing Assignment
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-57">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-57" aria-expanded="false" aria-controls="sidebar-collapse-57">
                <a href="./3.1.3.html"> 3.1.3 
    The Costs of Introducing Assignment
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-58">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-58" aria-expanded="true" aria-controls="sidebar-collapse-58">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-58" aria-expanded="true" aria-controls="sidebar-collapse-58">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.2.html">3.2 The Environment Model of Evaluation</a>
                </h5>
              </div>

              <div id="sidebar-collapse-58" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-59">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-59" aria-expanded="false" aria-controls="sidebar-collapse-59">
                <a href="./3.2.1.html"> 3.2.1 
    The Rules for Evaluation
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-60">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-60" aria-expanded="false" aria-controls="sidebar-collapse-60">
                <a href="./3.2.2.html"> 3.2.2 
    Applying Simple
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-61">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-61" aria-expanded="false" aria-controls="sidebar-collapse-61">
                <a href="./3.2.3.html"> 3.2.3 
    Frames as the Repository of Local State
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-62">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-62" aria-expanded="false" aria-controls="sidebar-collapse-62">
                <a href="./3.2.4.html"> 3.2.4 
    Internal
    
      <span style="color:green">Definitions</span>
      <span style="color:blue">Declarations</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-63">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-63" aria-expanded="false" aria-controls="sidebar-collapse-63">
                <a href="./3.2.5.html"> 3.2.5 
    CSE Machine
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-64">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-64" aria-expanded="true" aria-controls="sidebar-collapse-64">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-64" aria-expanded="true" aria-controls="sidebar-collapse-64">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.3.html">3.3 Modeling with Mutable Data</a>
                </h5>
              </div>

              <div id="sidebar-collapse-64" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-65">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-65" aria-expanded="false" aria-controls="sidebar-collapse-65">
                <a href="./3.3.1.html"> 3.3.1 
    Mutable List Structure
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-66">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-66" aria-expanded="false" aria-controls="sidebar-collapse-66">
                <a href="./3.3.2.html"> 3.3.2 
    Representing Queues
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-67">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-67" aria-expanded="false" aria-controls="sidebar-collapse-67">
                <a href="./3.3.3.html"> 3.3.3 
    Representing Tables
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-68">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-68" aria-expanded="false" aria-controls="sidebar-collapse-68">
                <a href="./3.3.4.html"> 3.3.4 
    A Simulator for Digital Circuits
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-69">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-69" aria-expanded="false" aria-controls="sidebar-collapse-69">
                <a href="./3.3.5.html"> 3.3.5 
    Propagation of Constraints
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-70">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-70" aria-expanded="true" aria-controls="sidebar-collapse-70">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-70" aria-expanded="true" aria-controls="sidebar-collapse-70">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.4.html">3.4 Concurrency: Time Is of the Essence</a>
                </h5>
              </div>

              <div id="sidebar-collapse-70" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-71">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-71" aria-expanded="false" aria-controls="sidebar-collapse-71">
                <a href="./3.4.1.html"> 3.4.1 
    The Nature of Time in Concurrent Systems
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-72">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-72" aria-expanded="false" aria-controls="sidebar-collapse-72">
                <a href="./3.4.2.html"> 3.4.2 
    Mechanisms for Controlling Concurrency
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-73">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-73" aria-expanded="true" aria-controls="sidebar-collapse-73">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-73" aria-expanded="true" aria-controls="sidebar-collapse-73">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.5.html">3.5 Streams</a>
                </h5>
              </div>

              <div id="sidebar-collapse-73" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-74">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-74" aria-expanded="false" aria-controls="sidebar-collapse-74">
                <a href="./3.5.1.html"> 3.5.1 
    Streams Are Delayed Lists
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-75">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-75" aria-expanded="false" aria-controls="sidebar-collapse-75">
                <a href="./3.5.2.html"> 3.5.2 
    Infinite Streams
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-76">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-76" aria-expanded="false" aria-controls="sidebar-collapse-76">
                <a href="./3.5.3.html"> 3.5.3 
    Exploiting the Stream Paradigm
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-77">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-77" aria-expanded="false" aria-controls="sidebar-collapse-77">
                <a href="./3.5.4.html"> 3.5.4 
    Streams and Delayed Evaluation
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-78">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-78" aria-expanded="false" aria-controls="sidebar-collapse-78">
                <a href="./3.5.5.html"> 3.5.5 
    Modularity of Functional Programs and Modularity of Objects
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-79">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-79" aria-expanded="true" aria-controls="sidebar-collapse-79">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-79" aria-expanded="true" aria-controls="sidebar-collapse-79">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.html">4 Metalinguistic Abstraction</a>
                </h5>
              </div>

              <div id="sidebar-collapse-79" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-80">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-80" aria-expanded="true" aria-controls="sidebar-collapse-80">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-80" aria-expanded="true" aria-controls="sidebar-collapse-80">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.1.html">4.1 The Metacircular Evaluator</a>
                </h5>
              </div>

              <div id="sidebar-collapse-80" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-81">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-81" aria-expanded="false" aria-controls="sidebar-collapse-81">
                <a href="./4.1.1.html"> 4.1.1 
    The Core of the Evaluator
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-82">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-82" aria-expanded="false" aria-controls="sidebar-collapse-82">
                <a href="./4.1.2.html"> 4.1.2 
    Representing
    
      <span style="color:green">Expressions</span>
      <span style="color:blue">Components</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-83">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-83" aria-expanded="false" aria-controls="sidebar-collapse-83">
                <a href="./4.1.3.html"> 4.1.3 
    Evaluator Data Structures
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-84">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-84" aria-expanded="false" aria-controls="sidebar-collapse-84">
                <a href="./4.1.4.html"> 4.1.4 
    Running the Evaluator as a Program
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-85">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-85" aria-expanded="false" aria-controls="sidebar-collapse-85">
                <a href="./4.1.5.html"> 4.1.5 
    Data as Programs
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-86">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-86" aria-expanded="false" aria-controls="sidebar-collapse-86">
                <a href="./4.1.6.html"> 4.1.6 
    Internal
    
      <span style="color:green">Definitions</span>
      <span style="color:blue">Declarations</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-87">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-87" aria-expanded="false" aria-controls="sidebar-collapse-87">
                <a href="./4.1.7.html"> 4.1.7 
    Separating Syntactic Analysis from Execution
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-88">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-88" aria-expanded="true" aria-controls="sidebar-collapse-88">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-88" aria-expanded="true" aria-controls="sidebar-collapse-88">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.2.html">4.2 
    
      <span style="color:green">Variations on a Scheme:</span>
    
    Lazy Evaluation
</a>
                </h5>
              </div>

              <div id="sidebar-collapse-88" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-89">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-89" aria-expanded="false" aria-controls="sidebar-collapse-89">
                <a href="./4.2.1.html"> 4.2.1 
    Normal Order and Applicative Order
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-90">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-90" aria-expanded="false" aria-controls="sidebar-collapse-90">
                <a href="./4.2.2.html"> 4.2.2 
    An Interpreter with Lazy Evaluation
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-91">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-91" aria-expanded="false" aria-controls="sidebar-collapse-91">
                <a href="./4.2.3.html"> 4.2.3 
    Streams as Lazy Lists
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-92">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-92" aria-expanded="true" aria-controls="sidebar-collapse-92">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-92" aria-expanded="true" aria-controls="sidebar-collapse-92">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.3.html">4.3 
    
      <span style="color:green">Variations on a Scheme:</span>
    
    Nondeterministic Computing
  </a>
                </h5>
              </div>

              <div id="sidebar-collapse-92" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-93">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-93" aria-expanded="false" aria-controls="sidebar-collapse-93">
                <a href="./4.3.1.html"> 4.3.1 
    
      <span style="color:green">Amb and Search</span>
      <span style="color:blue">Search and amb</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-94">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-94" aria-expanded="false" aria-controls="sidebar-collapse-94">
                <a href="./4.3.2.html"> 4.3.2 
    Examples of Nondeterministic Programs
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-95">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-95" aria-expanded="false" aria-controls="sidebar-collapse-95">
                <a href="./4.3.3.html"> 4.3.3 
    Implementing the
    
      <span style="color:green">Amb</span>
      <span style="color:blue">amb</span>
    
    Evaluator
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-96">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-96" aria-expanded="true" aria-controls="sidebar-collapse-96">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-96" aria-expanded="true" aria-controls="sidebar-collapse-96">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.4.html">4.4 Logic Programming</a>
                </h5>
              </div>

              <div id="sidebar-collapse-96" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-97">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-97" aria-expanded="false" aria-controls="sidebar-collapse-97">
                <a href="./4.4.1.html"> 4.4.1 
    Deductive Information Retrieval
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-98">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-98" aria-expanded="false" aria-controls="sidebar-collapse-98">
                <a href="./4.4.2.html"> 4.4.2 
    How the Query System Works
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-99">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-99" aria-expanded="false" aria-controls="sidebar-collapse-99">
                <a href="./4.4.3.html"> 4.4.3 
    Is Logic Programming Mathematical Logic?
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-100">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-100" aria-expanded="false" aria-controls="sidebar-collapse-100">
                <a href="./4.4.4.html"> 4.4.4 
    Implementing the Query System
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-101">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-101" aria-expanded="true" aria-controls="sidebar-collapse-101">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-101" aria-expanded="true" aria-controls="sidebar-collapse-101">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.html">5 Computing with Register Machines</a>
                </h5>
              </div>

              <div id="sidebar-collapse-101" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-102">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-102" aria-expanded="true" aria-controls="sidebar-collapse-102">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-102" aria-expanded="true" aria-controls="sidebar-collapse-102">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.1.html">5.1 Designing Register Machines</a>
                </h5>
              </div>

              <div id="sidebar-collapse-102" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-103">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-103" aria-expanded="false" aria-controls="sidebar-collapse-103">
                <a href="./5.1.1.html"> 5.1.1 
    A Language for Describing Register Machines
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-104">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-104" aria-expanded="false" aria-controls="sidebar-collapse-104">
                <a href="./5.1.2.html"> 5.1.2 
    Abstraction in Machine Design
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-105">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-105" aria-expanded="false" aria-controls="sidebar-collapse-105">
                <a href="./5.1.3.html"> 5.1.3 
    Subroutines
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-106">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-106" aria-expanded="false" aria-controls="sidebar-collapse-106">
                <a href="./5.1.4.html"> 5.1.4 
    Using a Stack to Implement Recursion
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-107">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-107" aria-expanded="false" aria-controls="sidebar-collapse-107">
                <a href="./5.1.5.html"> 5.1.5 
    Instruction Summary
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-108">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-108" aria-expanded="true" aria-controls="sidebar-collapse-108">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-108" aria-expanded="true" aria-controls="sidebar-collapse-108">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.2.html">5.2 A Register-Machine Simulator</a>
                </h5>
              </div>

              <div id="sidebar-collapse-108" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-109">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-109" aria-expanded="false" aria-controls="sidebar-collapse-109">
                <a href="./5.2.1.html"> 5.2.1 
    The Machine Model
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-110">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-110" aria-expanded="false" aria-controls="sidebar-collapse-110">
                <a href="./5.2.2.html"> 5.2.2 
    The Assembler
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-111">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-111" aria-expanded="false" aria-controls="sidebar-collapse-111">
                <a href="./5.2.3.html"> 5.2.3 
    
      <span style="color:green">Generating Execution Procedures for Instructions</span>
      <span style="color:blue">Instructions and Their Execution Functions</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-112">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-112" aria-expanded="false" aria-controls="sidebar-collapse-112">
                <a href="./5.2.4.html"> 5.2.4 
    Monitoring Machine Performance
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-113">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-113" aria-expanded="true" aria-controls="sidebar-collapse-113">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-113" aria-expanded="true" aria-controls="sidebar-collapse-113">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.3.html">5.3 Storage Allocation and Garbage Collection</a>
                </h5>
              </div>

              <div id="sidebar-collapse-113" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-114">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-114" aria-expanded="false" aria-controls="sidebar-collapse-114">
                <a href="./5.3.1.html"> 5.3.1 
    Memory as Vectors
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-115">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-115" aria-expanded="false" aria-controls="sidebar-collapse-115">
                <a href="./5.3.2.html"> 5.3.2 
    Maintaining the Illusion of Infinite Memory
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-116">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-116" aria-expanded="true" aria-controls="sidebar-collapse-116">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-116" aria-expanded="true" aria-controls="sidebar-collapse-116">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.4.html">5.4 The Explicit-Control Evaluator</a>
                </h5>
              </div>

              <div id="sidebar-collapse-116" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-117">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-117" aria-expanded="false" aria-controls="sidebar-collapse-117">
                <a href="./5.4.1.html"> 5.4.1 
    
      <span style="color:green">The Core of the Explicit-Control Evaluator</span>
      <span style="color:blue">The Dispatcher and Basic Evaluation</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-118">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-118" aria-expanded="false" aria-controls="sidebar-collapse-118">
                <a href="./5.4.2.html"> 5.4.2 
    
      <span style="color:green">
        Sequence Evaluation and Tail Recursion
      </span>
      <span style="color:blue">
        Evaluating Function Applications
      </span>
        
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-119">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-119" aria-expanded="false" aria-controls="sidebar-collapse-119">
                <a href="./5.4.3.html"> 5.4.3 
    
      <span style="color:green">
        Conditionals, Assignments and Definitions
      </span>
      <span style="color:blue">
        Blocks, Assignments, and Declarations
      </span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-120">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-120" aria-expanded="false" aria-controls="sidebar-collapse-120">
                <a href="./5.4.4.html"> 5.4.4 
    Running the Evaluator
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-121">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-121" aria-expanded="true" aria-controls="sidebar-collapse-121">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-121" aria-expanded="true" aria-controls="sidebar-collapse-121">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.5.html">5.5 Compilation</a>
                </h5>
              </div>

              <div id="sidebar-collapse-121" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-122">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-122" aria-expanded="false" aria-controls="sidebar-collapse-122">
                <a href="./5.5.1.html"> 5.5.1 
    Structure of the Compiler
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-123">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-123" aria-expanded="false" aria-controls="sidebar-collapse-123">
                <a href="./5.5.2.html"> 5.5.2 
    Compiling
    
      <span style="color:green">Expressions</span>
      <span style="color:blue">Components</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-124">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-124" aria-expanded="false" aria-controls="sidebar-collapse-124">
                <a href="./5.5.3.html"> 5.5.3 
    Compiling
    
      <span style="color:green">
	Combinations
      </span>
      <span style="color:blue">
	Applications and Return Statements
      </span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-125">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-125" aria-expanded="false" aria-controls="sidebar-collapse-125">
                <a href="./5.5.4.html"> 5.5.4 
    Combining Instruction Sequences
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-126">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-126" aria-expanded="false" aria-controls="sidebar-collapse-126">
                <a href="./5.5.5.html"> 5.5.5 
    An Example of Compiled Code
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-127">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-127" aria-expanded="false" aria-controls="sidebar-collapse-127">
                <a href="./5.5.6.html"> 5.5.6 
    Lexical Addressing
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-128">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-128" aria-expanded="false" aria-controls="sidebar-collapse-128">
                <a href="./5.5.7.html"> 5.5.7 
    Interfacing Compiled Code to the Evaluator
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-129">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-129" aria-expanded="false" aria-controls="sidebar-collapse-129">
                <a href="./references.html"> References</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-130">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-130" aria-expanded="false" aria-controls="sidebar-collapse-130">
                <a href="./making-of.html"> <span class='webonly'>About the SICP JS Project</span></a>
              </span>
            </h5>
          </div>
        </div>
        </div>
<div id='permalink-msg'>
<div class='screen'>
  <div class='alert alert-success'>
    <strong>Permalink copied!</strong>
  </div>
</div>
</div>
<div class='chapter-content'>

      <div class='chapter-title'>
        <div class='permalink'>
        <a name='top' class='permalink'> 
    5.5.5&nbsp;&nbsp;
    An Example of Compiled Code
  
        </a>
        </div>
      </div>
      <div class='chapter-text'>
        <div class='SECTION'>
    

  

  
  

  <div class='permalink'>
<a name='p1' class='permalink'></a><p>
    Now that we have seen all the elements of the compiler, let us examine
    an example of compiled code to see how things fit together.  We will
    compile the
    
      <span style="color:green">definition</span>
      <span style="color:blue">declaration</span>
    
    of a recursive
    
      <span style="color:green"><kbd>factorial</kbd></span>
      <span style="color:blue"><kbd>factorial</kbd></span>
    
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    
      <span style="color:green">
	by calling
	<kbd>compile</kbd>:
      </span>
      <span style="color:blue">
	by passing as first argument to
	<kbd>compile</kbd>
	the result of applying
	<kbd>parse</kbd> to
	a string representation of the program
	(here using
	
	
	
	
	back quotes
	<kbd>`</kbd>$\ldots$<kbd>`</kbd>, which work like
	single and double quotation marks
	but allow the string to span multiple lines):
      </span>
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
(compile
 '(define (factorial n)
    (if (= n 1)
        1
        (* (factorial (- n 1)) n)))
 'val
 'next)
      </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
compile(parse(`
function factorial(n) {
    return n === 1
           ? 1
           : factorial(n - 1) * n;
}
              `),
        "val",
        "next");
      </kbd></span></td></tr></table>
    We have specified that the value of the
    
      <span style="color:green"><kbd>define</kbd> expression</span>
      <span style="color:blue">declaration</span>
    
    should be placed in the <kbd>val</kbd> register.
    We don't care what the compiled
    code does after executing the
    
      <span style="color:green"><kbd>define</kbd>,</span>
      <span style="color:blue">declaration,</span>
    
    so our choice of
    
      <span style="color:green">
	<kbd>next</kbd>
      </span>
      <span style="color:blue">
	<kbd>"next"</kbd>
      </span>
    
    as the linkage
    descriptor is arbitrary.
  </p></div>

  <div class='permalink'>
<a name='p2' class='permalink'></a><p>
    
      <span style="color:green">
	<kbd>Compile</kbd>
	determines that the
	expression is a definition, so it
      </span>
      <span style="color:blue">
	The function <kbd>compile</kbd>
	determines that it was given a function declaration, so it transforms it
  to a constant declaration and then
      </span>
    
calls    
    
      <span style="color:green"><kbd>compile-definition</kbd> to compile </span>
      <span style="color:blue">
	<kbd>compile_declaration</kbd>. This compiles
      </span>
    
    code to compute the value to be assigned (targeted to
    <kbd>val</kbd>), followed by code to install the
    
      <span style="color:green">definition,</span>
      <span style="color:blue">declaration,</span>
    
    followed by code to put the value of the
    
      <span style="color:green">
	<kbd>define</kbd> (which is the symbol
	<kbd>ok</kbd>)
      </span>
      <span style="color:blue">
	declaration (which is the value
	<kbd>undefined</kbd>)
      </span>
    
    into the target register, followed finally by the linkage code.
    
      <span style="color:green">
	<kbd>Env</kbd>
      </span>
      <span style="color:blue">
	The <kbd>env</kbd> register
      </span>
    
    is preserved around the computation of the
    value, because it is needed in order to install the
    
      <span style="color:green">
	definition.
      </span>
      <span style="color:blue">
	declaration.
      </span>
    
    Because
    the linkage is
    
      <span style="color:green">
	<kbd>next</kbd>,
      </span>
      <span style="color:blue">
	<kbd>"next"</kbd>,
      </span>
    
    there is no linkage code
    in this case.  The skeleton of the compiled code is thus
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
$\langle save$ env $if\ modified\ by\ code\ to\ compute\ value\rangle$
$\langle compilation\ of\ definition\ value, target$ val$, linkage$ next$\rangle$
$\langle restore$ env $if\ saved\ above\rangle$
(perform (op define-variable!)
         (const factorial)
         (reg val)
         (reg env))
(assign val (const ok))
      </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
$\langle{}$<EM>save <kbd>env</kbd> if modified by code to compute value</EM>$\rangle$
$\langle{}$<EM>compilation of declaration value, target <kbd>val</kbd>, linkage <kbd>"next"</kbd></EM>$\rangle$
$\langle{}$<EM>restore <kbd>env</kbd> if saved above</EM>$\rangle$
perform(list(op("assign_symbol_value"),
             constant("factorial"),
             reg("val"),
             reg("env"))),
assign("val", constant(undefined))
      </kbd></span></td></tr></table>
  </p></div>

  <div class='permalink'>
<a name='p3' class='permalink'></a><p>
    The expression that is
    
      <span style="color:green">to be</span>
      <span style="color:blue"></span>
    
    compiled to produce the value for the
    
      <span style="color:green">variable</span>
      <span style="color:blue">name</span>
    
    <kbd>factorial</kbd>
    is a
    
      <span style="color:green"><kbd>lambda</kbd></span>
      <span style="color:blue">lambda</span>
    
    expression whose value is the
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    that computes factorials.
    
      <span style="color:green">
	<kbd>Compile</kbd>
      </span>
      <span style="color:blue">
	The function
	<kbd>compile</kbd>
      </span>
    
    handles this
    by calling
    
      <span style="color:green"><kbd>compile-lambda</kbd>,</span>
      <span style="color:blue"><kbd>compile_lambda_expression</kbd>,
      </span>
    
    which compiles the
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    body, labels it as a new entry point, and generates the instruction that
    will combine the
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    body at the new entry point with the runtime environment and assign the
    result to <kbd>val</kbd>.  The sequence then skips around
    the compiled
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    code, which is inserted at this point.  The
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    code itself begins by extending the
    
      <span style="color:green">procedure's definition</span>
      <span style="color:blue">function's declaration</span>
    
    environment by a frame that binds the
    <span style="color:green">formal</span>
    parameter <kbd>n</kbd> to the
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    argument.  Then comes the actual
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    body.  Since this code for the value of the
    
      <span style="color:green">variable</span>
      <span style="color:blue">name</span>
    
    doesn't modify the <kbd>env</kbd> register, the
    optional <kbd>save</kbd>
    and <kbd>restore</kbd> shown above aren't
    generated.  (The
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    code at
    <span style="color:green"><kbd>entry2</kbd></span><span style="color:blue"><kbd>entry1</kbd></span>
     isn't executed at this point,
    so its use of <kbd>env</kbd> is irrelevant.)
    Therefore, the skeleton for the compiled code becomes
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
  (assign val (op make-compiled-procedure)
              (label entry2)
              (reg env))
  (goto (label after-lambda1))
entry2
  (assign env (op compiled-procedure-env) (reg proc))
  (assign env (op extend-environment)
              (const (n))
              (reg argl)
              (reg env))
  $\langle compilation\ of\ procedure\ body\rangle$
after-lambda1
  (perform (op define-variable!)
           (const factorial)
           (reg val)
           (reg env))
  (assign val (const ok))
      </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
$\texttt{ }\texttt{ }$assign("val", list(op("make_compiled_function"), 
                     label("entry1"), 
                     reg("env"))),
  go_to(label("after_lambda2")),
"entry1",
  assign("env", list(op("compiled_function_env"), reg("fun"))),
  assign("env", list(op("extend_environment"),
                     constant(list("n")), 
                     reg("argl"), 
                     reg("env"))),
  $\langle{}$<EM>compilation of function body</EM>$\rangle$
"after_lambda2",
  perform(list(op("assign_symbol_value"), 
               constant("factorial"), 
               reg("val"), 
               reg("env"))),
  assign("val", constant(undefined))
      </kbd></span></td></tr></table>
  </p></div>

  <div class='permalink'>
<a name='p4' class='permalink'></a><p>
    A
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    body is always compiled (by
    
      <span style="color:green"><kbd>compile-lambda-body</kbd>)</span>
      <span style="color:blue">
      <kbd>compile_lambda_body</kbd>)</span>
    
    
      <span style="color:green">as a sequence</span>
    
    with target <kbd>val</kbd> and linkage
    
      <span style="color:green">
	<kbd>return</kbd>.
      </span>
      <span style="color:blue">
	<kbd>"next"</kbd>.
      </span>
    
    The
    
      <span style="color:green">
	sequence
      </span>
      <span style="color:blue">
	body
      </span>
    
    in this case consists of
    a single
    
      <span style="color:green">
	<kbd>if</kbd> expression:
      </span>
      <span style="color:blue">
	return statement:<a class='superscript' id='footnote-link-1' href='#footnote-1'style="color:blue">[1]</a>
      </span>
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
(if (= n 1)
    1
    (* (factorial (- n 1)) n))
      </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
return n === 1
       ? 1
       : factorial(n - 1) * n;
      </kbd></span></td></tr></table>

    <table width="100%">
        <colgroup><col width="48%"><col width="1%"><col width="51%"></colgroup>
        <tr>
          <td class="meta" style = "color:grey; text-align: center">Original</td>
          <td></td>
          <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
        </tr>
        <tr><td>    </td>
          <td></td>
          <td><span style="color:blue">
	      The function
	      <kbd>compile_return_statement</kbd>
        generates code to revert the stack using the marker and to restore
       	the <kbd>continue</kbd> register,
	      and then compiles the return 
        expression with target <kbd>val</kbd> and linkage
	      <kbd>"return"</kbd>, because
	      its value is to be returned from the function.
      </span></td></tr></table>
    
      <span style="color:green">
	<kbd>Compile-if</kbd>
      </span>
      <span style="color:blue">
	The return expression is a conditional expression, 
	for which
	<kbd>compile_conditional</kbd>
      </span>
    
    generates code that first computes the predicate (targeted to
    <kbd>val</kbd>), then checks the result and branches
    around the true branch if the predicate is false.
    
      <span style="color:green"><kbd>Env</kbd></span>
      <span style="color:blue">Registers <kbd>env</kbd></span>
    
    and <kbd>continue</kbd>
    are preserved around the predicate code, since they may be needed for the
    rest of the
    
      <span style="color:green"><kbd>if</kbd></span>
      <span style="color:blue">conditional</span>
    
    expression.
    <table width="100%">
        <colgroup><col width="48%"><col width="1%"><col width="51%"></colgroup>
        <tr>
          <td class="meta" style = "color:grey; text-align: center">Original</td>
          <td></td>
          <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
        </tr>
        <tr><td><span style="color:green">
	Since the <kbd>if</kbd> expression
	is the final expression (and only expression) in the sequence making up
	the procedure
	body, its target is <kbd>val</kbd> and its linkage is
	<kbd>return</kbd>,
	so the
      </span>    </td>
          <td></td>
          <td><span style="color:blue">
	The
      </span></td></tr></table>
    true and false branches are both
    compiled with target <kbd>val</kbd> and linkage
    
      <span style="color:green">
	<kbd>return</kbd>.
      </span>
      <span style="color:blue">
	<kbd>"return"</kbd>.
      </span>
    
    (That is, the value of the conditional,
    which is the value computed by either of its branches, is the value of the
    
      <span style="color:green">procedure.)</span>
      <span style="color:blue">function.)</span>
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
  $\langle save$ continue, env $if\ modified\ by\ predicate\ and\ needed\ by\ branches\rangle$
  $\langle compilation\ of\ predicate, target$ val$,\ linkage$ next$\rangle$
  $\langle restore$ continue, env $if\ saved\ above\rangle$
  (test (op false?) (reg val))
  (branch (label false-branch4))
true-branch5
  $\langle compilation\ of\ true\ branch, target$ val$,\ linkage$ return$\rangle$
false-branch4
  $\langle compilation\ of\ false\ branch, target$ val$,\ linkage$ return$\rangle$
after-if3
      </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
$\texttt{ }\texttt{ }$revert_stack_to_marker(),
  restore("continue"),
  $\langle{}$<EM>save <kbd>continue</kbd>, <kbd>env</kbd> if modified by predicate and needed by branches</EM>$\rangle$
  $\langle{}$<EM>compilation of predicate, target <kbd>val</kbd>, linkage <kbd>"next"</kbd></EM>$\rangle$
  $\langle{}$<EM>restore <kbd>continue</kbd>, <kbd>env</kbd> if saved above</EM>$\rangle$
  test(list(op("is_falsy"), reg("val"))),
  branch(label("false_branch4")),
"true_branch3",
  $\langle{}$<EM>compilation of true branch, target <kbd>val</kbd>, linkage <kbd>"return"</kbd></EM>$\rangle$
"false_branch4",
  $\langle{}$<EM>compilation of false branch, target <kbd>val</kbd>, linkage <kbd>"return"</kbd></EM>$\rangle$
"after_cond5",
      </kbd></span></td></tr></table>
  </p></div>

  <div class='permalink'>
<a name='p5' class='permalink'></a><p>
    The predicate
    
      <span style="color:green"><kbd>(= n 1)</kbd></span>
      <span style="color:blue"><kbd>n === 1</kbd></span>
    
    is a
    
      <span style="color:green">procedure call.</span>
      <span style="color:blue">function application (after transformation of the
      operator combination).
      </span>
    
    This looks up the
    
      <span style="color:green">
    operator
    (the symbol <kbd>=</kbd>)
      </span>
      <span style="color:blue">
	function expression
	(the symbol <kbd>"==="</kbd>)
      </span>
    
    and places this value in
    
      <span style="color:green"><kbd>proc</kbd>.</span>
      <span style="color:blue"><kbd>fun</kbd>.</span>
    
    It then assembles the arguments <kbd>1</kbd> and the value
    of <kbd>n</kbd> into <kbd>argl</kbd>.
    Then it tests whether
    
      <span style="color:green"><kbd>proc</kbd></span>
      <span style="color:blue"><kbd>fun</kbd></span>
    
    contains a primitive or a compound
    
      <span style="color:green">procedure,</span>
      <span style="color:blue">function,</span>
    
    and dispatches to a primitive branch or a compound branch accordingly.
    Both branches resume at the
    
      <span style="color:green"><kbd>after-call</kbd></span>
      <span style="color:blue"><kbd>after_call</kbd></span>
    
    label.
    
      <span style="color:blue">
      The compound branch must set up
      <kbd>continue</kbd> to jump past the primitive
      branch and push a marker to the stack to match the revert
      operation in the compiled return statement of the function.
      </span>
    
    The requirements to preserve registers around the evaluation of the
    
      <span style="color:green">
	operator and operands
      </span>
      <span style="color:blue">
	function and argument expressions
      </span>
    
    don't result in
    any saving of registers, because in this case those evaluations don't
    modify the registers in question.
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
  (assign proc
          (op lookup-variable-value) (const =) (reg env))
  (assign val (const 1))
  (assign argl (op list) (reg val))
  (assign val (op lookup-variable-value) (const n) (reg env))
  (assign argl (op cons) (reg val) (reg argl))
  (test (op primitive-procedure?) (reg proc))
  (branch (label primitive-branch17))
compiled-branch16
  (assign continue (label after-call15))
  (assign val (op compiled-procedure-entry) (reg proc))
  (goto (reg val))
primitive-branch17
  (assign val (op apply-primitive-procedure)
              (reg proc)
              (reg argl))
after-call15
      </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
$\texttt{ }\texttt{ }$assign("fun", list(op("lookup_symbol_value"),
                     constant("==="), reg("env"))),
  assign("val", constant(1)),
  assign("argl", list(op("list"), reg("val"))),
  assign("val", list(op("lookup_symbol_value"),
                     constant("n"), reg("env"))),
  assign("argl", list(op("pair"), reg("val"), reg("argl"))),
  test(list(op("is_primitive_function"), reg("fun"))),
  branch(label("primitive_branch6")),
"compiled_branch7",
  assign("continue", label("after_call8")),
  save("continue"),
  push_marker_to_stack(),
  assign("val", list(op("compiled_function_entry"), reg("fun"))),
  go_to(reg("val")),
"primitive_branch6",
  assign("val", list(op("apply_primitive_function"),
                     reg("fun"), 
                     reg("argl"))),
"after_call8",
      </kbd></span></td></tr></table>
  </p></div>

  <div class='permalink'>
<a name='p6' class='permalink'></a><p>
    The true branch, which is the constant 1, compiles (with target
    <kbd>val</kbd> and linkage
    
      <span style="color:green">
	<kbd>return</kbd>)
      </span>
      <span style="color:blue">
	<kbd>"return"</kbd>)
      </span>
    
    to
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
(assign val (const 1))
(goto (reg continue))
      </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
$\texttt{ }\texttt{ }$assign("val", constant(1)),
  go_to(reg("continue")),
      </kbd></span></td></tr></table>
    The code for the false branch is another
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    call, where the
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    is the value of the symbol
    
      <span style="color:green"><kbd>*</kbd>,</span>
      <span style="color:blue"><kbd>"*"</kbd>,</span>
    
    and the arguments
    are <kbd>n</kbd> and the result of another
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    call (a call to <kbd>factorial</kbd>).
    Each of these calls sets up
    
      <span style="color:green"><kbd>proc</kbd></span>
      <span style="color:blue"><kbd>fun</kbd></span>
    
    and <kbd>argl</kbd> and its own primitive
    and compound branches.  Figure&nbsp;<REF NAME="fig:comp-factorial1"><a class="superscript" id="5.5.5-fig-link-5.22" href="./5.5.5.html#fig_5.22">5.22</a></REF>
    shows the complete compilation of the
    
      <span style="color:green">
	definition
      </span>
      <span style="color:blue">
	declaration
      </span>
    
    of the <kbd>factorial</kbd>
    
      <span style="color:green">procedure.</span>
      <span style="color:blue">function.</span>
    
    Notice that the possible <kbd>save</kbd> and
    <kbd>restore</kbd> of
    <kbd>continue</kbd> and
    <kbd>env</kbd> around the predicate, shown above,
    are in fact generated, because these registers are modified by the
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    call in the predicate and needed for the
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    call and the
    
      <span style="color:green">
	<kbd>return</kbd>
      </span>
      <span style="color:blue">
	<kbd>"return"</kbd>
      </span>
    
    linkage in the branches.
  </p></div>

  <FIGURE><table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
;; construct the procedure and skip over code for the procedure body
  (assign val
          (op make-compiled-procedure) (label entry2) (reg env))
  (goto (label after-lambda1))

entry2     ; calls to factorial will enter here
  (assign env (op compiled-procedure-env) (reg proc))
  (assign env
         (op extend-environment) (const (n)) (reg argl) (reg env))
;; begin actual procedure body
  (save continue)
  (save env)

;; compute (= n 1)
  (assign proc (op lookup-variable-value) (const =) (reg env))
  (assign val (const 1))
  (assign argl (op list) (reg val))
  (assign val (op lookup-variable-value) (const n) (reg env))
  (assign argl (op cons) (reg val) (reg argl))
  (test (op primitive-procedure?) (reg proc))
  (branch (label primitive-branch17))
compiled-branch16
  (assign continue (label after-call15))
  (assign val (op compiled-procedure-entry) (reg proc))
  (goto (reg val))
primitive-branch17
  (assign val (op apply-primitive-procedure) (reg proc) (reg argl))

  after-call15   ; val now contains result of (= n 1)
  (restore env)
  (restore continue)
  (test (op false?) (reg val))
  (branch (label false-branch4))
true-branch5  ; return 1
  (assign val (const 1))
  (goto (reg continue))

false-branch4
;; compute and return $\texttt{(* (factorial (- n 1)) n)}$
  (assign proc (op lookup-variable-value) (const *) (reg env))
  (save continue)
  (save proc)   ; save * procedure
  (assign val (op lookup-variable-value) (const n) (reg env))
  (assign argl (op list) (reg val))
  (save argl)   ; save partial argument list for *

;; compute $\texttt{(factorial (- n 1))}$, which is the other argument for *
  (assign proc
          (op lookup-variable-value) (const factorial) (reg env))
  (save proc)  ; save factorial procedure
    </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
// construct the function and skip over the code for the function body
  assign("val", list(op("make_compiled_function"), 
                     label("entry1"), reg("env"))),
  go_to(label("after_lambda2")),
"entry1",                           // calls to $\texttt{factorial}$ will enter here
  assign("env", list(op("compiled_function_env"), reg("fun"))),
  assign("env", list(op("extend_environment"), constant(list("n")), 
                     reg("argl"), reg("env"))),
// begin actual function body
  revert_stack_to_marker(),         // starts with a return statement
  restore("continue"),
  save("continue"),                 // preserve registers across predicate
  save("env"),
// compute $\texttt{n === 1}$
  assign("fun", list(op("lookup_symbol_value"), constant("==="), reg("env"))),
  assign("val", constant(1)),
  assign("argl", list(op("list"), reg("val"))),
  assign("val", list(op("lookup_symbol_value"), constant("n"), reg("env"))),
  assign("argl", list(op("pair"), reg("val"), reg("argl"))),
  test(list(op("is_primitive_function"), reg("fun"))),
  branch(label("primitive_branch6")),
"compiled_branch7",
  assign("continue", label("after_call8")),
  save("continue"),
  push_marker_to_stack(),
  assign("val", list(op("compiled_function_entry"), reg("fun"))),
  go_to(reg("val")),
"primitive_branch6",
  assign("val", list(op("apply_primitive_function"), reg("fun"), reg("argl"))),
"after_call8",                      // $\texttt{val}$ now contains result of $\texttt{n === 1}$
  restore("env"),
  restore("continue"),
  test(list(op("is_falsy"), reg("val"))),
  branch(label("false_branch4")),
"true_branch3",                     // return 1
  assign("val", constant(1)),
  go_to(reg("continue")),
"false_branch4",
// compute and return $\texttt{factorial(n - 1) * n}$
  assign("fun", list(op("lookup_symbol_value"), constant("*"), reg("env"))),
  save("continue"),
  save("fun"),                      // save $\texttt{*}$ function
  assign("val", list(op("lookup_symbol_value"), constant("n"), reg("env"))),
  assign("argl", list(op("list"), reg("val"))),
  save("argl"),                     // save partial argument list for $\texttt{*}$
// compute $\texttt{factorial(n - 1)}$ which is the other argument for $\texttt{*}$
  assign("fun", list(op("lookup_symbol_value"), 
                     constant("factorial"), reg("env"))),
  save("fun"),                      // save $\texttt{factorial}$ function
    </kbd></span></td></tr></table>
      <div class="chapter-text-CAPTION">
      <b><a class="caption" href="./5.5.5.html#fig_5.22">Figure 5.22 </a></b>
    Compilation of the declaration of the <kbd>factorial</kbd>
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    (continued on next page).
  </div></FIGURE>
  <FIGURE><table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
  ;; $\texttt{compute (- n 1)}$, which is the argument for $\texttt{factorial}$
  (assign proc (op lookup-variable-value) (const -) (reg env))
  (assign val (const 1))
  (assign argl (op list) (reg val))
  (assign val (op lookup-variable-value) (const n) (reg env))
  (assign argl (op cons) (reg val) (reg argl))
  (test (op primitive-procedure?) (reg proc))
  (branch label primitive-branch8))
compiled-branch7
  (assign continue (label after-call6))
  (assign val (op compiled-procedure-entry) (reg proc))
  (goto (reg val))
primitive-branch8
  (assign val (op apply-primitive-procedure) (reg proc) (reg argl))

after-call6   ; val now contains result of $\texttt{(- n 1)}$
  (assign argl (op list) (reg val))
  (restore proc) ; restore factorial
;; apply factorial
  (test (op primitive-procedure?) (reg proc))
  (branch (label primitive-branch11))
compiled-branch10
  (assign continue (label after-call9))
  (assign val (op compiled-procedure-entry) (reg proc))
  (goto (reg val))
primitive-branch11
  (assign val (op apply-primitive-procedure) (reg proc) (reg argl))

after-call9      ; val now contains result of $\texttt{(factorial (- n 1))}$
  (restore argl) ; restore partial argument list for *
  (assign argl (op cons) (reg val) (reg argl))
  (restore proc) ; restore *
  (restore continue)
  ;; apply * and return its value
  (test (op primitive-procedure?) (reg proc))
  (branch (label primitive-branch14))
compiled-branch13
;; note that a compound procedure here is called tail-recursively
  (assign val (op compiled-procedure-entry) (reg proc))
  (goto (reg val))
primitive-branch14
  (assign val (op apply-primitive-procedure) (reg proc) (reg argl))
  (goto (reg continue))
after-call12
after-if3
after-lambda1
;; assign the procedure to the variable factorial
  (perform
  (op define-variable!) (const factorial) (reg val) (reg env))
  (assign val (const ok))
    </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
// compute $\texttt{n - 1}$ which is the argument for $\texttt{factorial}$
  assign("fun", list(op("lookup_symbol_value"), constant("-"), reg("env"))),
  assign("val", constant(1)),
  assign("argl", list(op("list"), reg("val"))),
  assign("val", list(op("lookup_symbol_value"), constant("n"), reg("env"))),
  assign("argl", list(op("pair"), reg("val"), reg("argl"))),
  test(list(op("is_primitive_function"), reg("fun"))),
  branch(label("primitive_branch10")),
"compiled_branch11",
  assign("continue", label("after_call12")),
  save("continue"),
  push_marker_to_stack(),
  assign("val", list(op("compiled_function_entry"), reg("fun"))),
  go_to(reg("val")),
"primitive_branch10",
  assign("val", list(op("apply_primitive_function"), reg("fun"), reg("argl"))),
"after_call12",                     // $\texttt{val}$ now contains result of $\texttt{n - 1}$
  assign("argl", list(op("list"), reg("val"))),
  restore("fun"),                   // restore $\texttt{factorial}$
// apply $\texttt{factorial}$
  test(list(op("is_primitive_function"), reg("fun"))),
  branch(label("primitive_branch14")),
"compiled_branch15",
  assign("continue", label("after_call16")),
  save("continue"),                 // set up for compiled function $-$
  push_marker_to_stack(),           //   return in function will restore stack
  assign("val", list(op("compiled_function_entry"), reg("fun"))),
  go_to(reg("val")),
"primitive_branch14",
  assign("val", list(op("apply_primitive_function"), reg("fun"), reg("argl"))),
"after_call16",                     // $\texttt{val}$ now contains result of $\texttt{factorial(n - 1)}$
  restore("argl"),                  // restore partial argument list for $\texttt{*}$
  assign("argl", list(op("pair"), reg("val"), reg("argl"))),
  restore("fun"),                   // restore $\texttt{*}$
  restore("continue"),
// apply $\texttt{*}$ and return its value
  test(list(op("is_primitive_function"), reg("fun"))),
  branch(label("primitive_branch18")),
"compiled_branch19", // note that a compound function here is called tail-recursively
  save("continue"),
  push_marker_to_stack(),
  assign("val", list(op("compiled_function_entry"), reg("fun"))),
  go_to(reg("val")),
"primitive_branch18",
  assign("val", list(op("apply_primitive_function"), reg("fun"), reg("argl"))),
  go_to(reg("continue")),
"after_call20",
"after_cond5",
"after_lambda2",
// assign the function to the name $\texttt{factorial}$
  perform(list(op("assign_symbol_value"), 
               constant("factorial"), reg("val"), reg("env"))),
  assign("val", constant(undefined))
    </kbd></span></td></tr></table>
      <div class="chapter-text-CAPTION">
      <b><a class="caption" href="./5.5.5.html#fig_5.23">Figure 5.23 </a></b>(continued)</div></FIGURE>

  
    <span style="color:green">
      
    </span>
    <span style="color:blue">
      
    </span>
  
  
  
    <div class="permalink">
    <a name="ex_5.37" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_5.37">Exercise 5.37 </a></b> 
  
    Consider the following declaration of a factorial
    
      <span style="color:green">procedure,</span>
      <span style="color:blue">function,</span>
    
    which is slightly different from the one given above:
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
(define (factorial-alt n)
  (if (= n 1)
      1
      (* n (factorial-alt (- n 1)))))
      </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
function factorial_alt(n) {
    return n === 1
           ? 1
           : n * factorial_alt(n - 1);
}
      </kbd></span></td></tr></table>
    Compile this
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    and compare the resulting code with that produced for
    <kbd>factorial</kbd>.  Explain any differences you find.
    Does either program execute more efficiently than the other?
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#no_solution_125_1_div" data-toggle="collapse">Add solution</button></div>
      <div class="solution_content collapse" id="no_solution_125_1_div">There is currently no solution available for this exercise. This textbook adaptation is a community effort. Do consider contributing by providing a solution for this exercise, using a Pull Request in <a address="https://github.com/source-academy/sicp" href="https://github.com/source-academy/sicp">Github</a>.</div>
      </div>
    
</EXERCISE></div>


  
    <div class="permalink">
    <a name="ex_5.38" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_5.38">Exercise 5.38 </a></b> 
  
    Compile the
    
    
    iterative factorial
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
(define (factorial n)
  (define (iter product counter)
    (if (> counter n)
        product
        (iter (* counter product)
        (+ counter 1))))
  (iter 1 1))
      </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
function factorial(n) {
    function iter(product, counter) {
        return counter > n
               ? product
               : iter(product * counter, counter + 1);
    }
    return iter(1, 1);
}
      </kbd></span></td></tr></table>
    Annotate the resulting code, showing the essential difference between
    the code for iterative and recursive versions of
    <kbd>factorial</kbd> that makes one process build up
    stack space and the other run in constant stack space.
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#no_solution_125_2_div" data-toggle="collapse">Add solution</button></div>
      <div class="solution_content collapse" id="no_solution_125_2_div">There is currently no solution available for this exercise. This textbook adaptation is a community effort. Do consider contributing by providing a solution for this exercise, using a Pull Request in <a address="https://github.com/source-academy/sicp" href="https://github.com/source-academy/sicp">Github</a>.</div>
      </div>
    
</EXERCISE></div>



    <div class="permalink">
    <a name="ex_5.39" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_5.39">Exercise 5.39 </a></b> 
  
  What
  
    <span style="color:green">
      expression
    </span>
    <span style="color:blue">
      program
    </span>
  
  was compiled to produce the code shown in
  figure&nbsp;<REF NAME="fig:compilation-example1"><a class="superscript" id="5.5.5-fig-link-5.24" href="./5.5.5.html#fig_5.24">5.24</a></REF>?
  

      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#no_solution_125_3_div" data-toggle="collapse">Add solution</button></div>
      <div class="solution_content collapse" id="no_solution_125_3_div">There is currently no solution available for this exercise. This textbook adaptation is a community effort. Do consider contributing by providing a solution for this exercise, using a Pull Request in <a address="https://github.com/source-academy/sicp" href="https://github.com/source-academy/sicp">Github</a>.</div>
      </div>
    
</EXERCISE></div>

      
  <FIGURE><table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
  (assign val (op make-compiled-procedure) label entry16)
                                           (reg env))
  (goto (label after-lambda15))
entry16
  (assign env (op compiled-procedure-env) (reg proc))
  (assign env
    (op extend-environment) (const (x)) (reg argl) (reg env))
  (assign proc (op lookup-variable-value) (const +) (reg env))
  (save continue)
  (save proc)
  (save env)
  (assign proc (op lookup-variable-value) (const g) (reg env))
  (save proc)
  (assign proc (op lookup-variable-value) (const +) (reg env))
  (assign val (const 2))
  (assign argl (op list) (reg val))
  (assign val (op lookup-variable-value) (const x) (reg env))
  (assign argl (op cons) (reg val) (reg argl))
  (test (op primitive-procedure?) (reg proc))
  (branch (label primitive-branch19))
compiled-branch18
  (assign continue (label after-call17))
  (assign val (op compiled-procedure-entry) (reg proc))
  (goto (reg val))
primitive-branch19
  (assign val (op apply-primitive-procedure) (reg proc) (reg argl))
after-call17
  (assign argl (op list) (reg val))
  (restore proc)
  (test (op primitive-procedure?) (reg proc))
  (branch (label primitive-branch22))
compiled-branch21
  (assign continue (label after-call20))
  (assign val (op compiled-procedure-entry) (reg proc))
  (goto (reg val))
primitive-branch22
  (assign val (op apply-primitive-procedure) (reg proc) (reg argl))
    </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
$\texttt{ }\texttt{ }$assign("val", list(op("make_compiled_function"), 
                     label("entry1"), reg("env"))),
"entry1"
  assign("env", list(op("compiled_function_env"), reg("fun"))), 
  assign("env", list(op("extend_environment"), 
                     constant(list("x")), reg("argl"), reg("env"))), 
  revert_stack_to_marker(), 
  restore("continue"), 
  assign("fun", list(op("lookup_symbol_value"), constant("+"), reg("env"))), 
  save("continue"), 
  save("fun"), 
  save("env"), 
  assign("fun", list(op("lookup_symbol_value"), constant("g"), reg("env"))), 
  save("fun"), 
  assign("fun", list(op("lookup_symbol_value"), constant("+"), reg("env"))), 
  assign("val", constant(2)), 
  assign("argl", list(op("list"), reg("val"))), 
  assign("val", list(op("lookup_symbol_value"), constant("x"), reg("env"))), 
  assign("argl", list(op("pair"), reg("val"), reg("argl"))), 
  test(list(op("is_primitive_function"), reg("fun"))), 
  branch(label("primitive_branch3")), 
"compiled_branch4"
  assign("continue", label("after_call5")), 
  save("continue"), 
  push_marker_to_stack(), 
  assign("val", list(op("compiled_function_entry"), reg("fun"))), 
  go_to(reg("val")), 
"primitive_branch3", 
  assign("val", list(op("apply_primitive_function"), reg("fun"), reg("argl"))), 
"after_call5", 
  assign("argl", list(op("list"), reg("val"))), 
  restore("fun"), 
  test(list(op("is_primitive_function"), reg("fun"))), 
  branch(label("primitive_branch7")), 
"compiled_branch8", 
  assign("continue", label("after_call9")), 
  save("continue"), 
  push_marker_to_stack(), 
  assign("val", list(op("compiled_function_entry"), reg("fun"))), 
  go_to(reg("val")), 
"primitive_branch7", 
  assign("val", list(op("apply_primitive_function"), reg("fun"), reg("argl"))), 
"after_call9", 
  assign("argl", list(op("list"), reg("val"))), 
  restore("env"), 
  assign("val", list(op("lookup_symbol_value"), constant("x"), reg("env"))), 
  assign("argl", list(op("pair"), reg("val"), reg("argl"))), 
  restore("fun"), 
  restore("continue"), 
  test(list(op("is_primitive_function"), reg("fun"))), 
  branch(label("primitive_branch11")), 
    </kbd></span></td></tr></table>
      <div class="chapter-text-CAPTION">
      <b><a class="caption" href="./5.5.5.html#fig_5.24">Figure 5.24 </a></b>
    An example of compiler output (continued on next page).
    See exercise&nbsp;<REF NAME="ex:compiled-code"><a class="superscript" id="5.5.5-ex-link-5.39" href="./5.5.5.html#ex_5.39">5.39</a></REF>.
  </div></FIGURE>
  <FIGURE><table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
after-call20
  (assign argl (op list), (reg val))
  (restore env)
  (assign val (op lookup-variable-value) (const x) (reg env))
  (assign argl (op cons) (reg val) (reg argl))
  (restore proc)
  (restore continue)
  (test (op primitive-procedure?) (reg proc))
  (branch label primitive-branch25))
compiled-branch24
  (assign val (op compiled-procedure-entry) (reg proc))
  (goto (reg val))
primitive-branch25
  (assign val (op apply-primitive-procedure) (reg proc) (reg argl))
  (goto (reg continue))
after-call23
after-lambda15
  (perform (op define-variable!) (const f) (reg val) (reg env))
  (assign val (const ok))
    </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
"compiled_branch12", 
  save("continue"), 
  push_marker_to_stack(), 
  assign("val", list(op("compiled_function_entry"), reg("fun"))), 
  go_to(reg("val")), 
"primitive_branch11", 
  assign("val", list(op("apply_primitive_function"), reg("fun"), reg("argl"))), 
  go_to(reg("continue")), 
"after_call13", 
"after_lambda2", 
  perform(list(op("assign_symbol_value"),
               constant("f"), reg("val"), reg("env"))),
  assign("val", constant(undefined))
    </kbd></span></td></tr></table>
      <div class="chapter-text-CAPTION">
      <b><a class="caption" href="./5.5.5.html#fig_5.25">Figure 5.25 </a></b>(continued)</div></FIGURE>

  

  
    <div class="permalink">
    <a name="ex_5.40" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_5.40">Exercise 5.40 </a></b> 
  
    What
    
    
      <span style="color:green">
	
      </span>
      <span style="color:blue">
	
      </span>
    
    order of evaluation does our compiler produce for
    
      <span style="color:green">operands of a combination?</span>
      <span style="color:blue">arguments of an application?</span>
    
    Is it left-to-right (as mandated by the ECMAScript specification), right-to-left, or some other order?
    Where in the compiler is this order determined?  Modify the compiler
    so that it produces some other order of evaluation.  (See the
    discussion of order of evaluation for the explicit-control evaluator
    in section&nbsp;<REF NAME="sec:eceval-core"><a class="superscript" id="5.5.5-sec-link-5.4.1" href="./5.4.1.html">5.4.1</a></REF>.)  How does changing the
    order of
    
      <span style="color:green">operand</span>
      <span style="color:blue">argument</span>
    
    evaluation affect the efficiency of the code that
    constructs the argument list?
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#no_solution_125_4_div" data-toggle="collapse">Add solution</button></div>
      <div class="solution_content collapse" id="no_solution_125_4_div">There is currently no solution available for this exercise. This textbook adaptation is a community effort. Do consider contributing by providing a solution for this exercise, using a Pull Request in <a address="https://github.com/source-academy/sicp" href="https://github.com/source-academy/sicp">Github</a>.</div>
      </div>
    
</EXERCISE></div>


  
    <div class="permalink">
    <a name="ex_5.41" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_5.41">Exercise 5.41 </a></b> 
  
    One way to understand the compiler's
    
    
    <kbd>preserving</kbd> mechanism for
    optimizing stack usage is to see what extra operations would
    be generated if we did not use this idea.  Modify
    <kbd>preserving</kbd> so
    that it always generates the <kbd>save</kbd> and
    <kbd>restore</kbd> operations.
    Compile some simple expressions and identify the unnecessary stack
    operations that are generated.
    Compare the code to that generated with the
    <kbd>preserving</kbd> mechanism intact.
    
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#no_solution_125_5_div" data-toggle="collapse">Add solution</button></div>
      <div class="solution_content collapse" id="no_solution_125_5_div">There is currently no solution available for this exercise. This textbook adaptation is a community effort. Do consider contributing by providing a solution for this exercise, using a Pull Request in <a address="https://github.com/source-academy/sicp" href="https://github.com/source-academy/sicp">Github</a>.</div>
      </div>
    
</EXERCISE></div>


  
    <div class="permalink">
    <a name="ex_5.42" class="permalink"></a><EXERCISE><b><a class="exercise-number permalink" id="ex_5.42">Exercise 5.42 </a></b> 
  
    
    Our compiler is clever about avoiding unnecessary stack operations,
    but it is not clever at all when it comes to compiling calls to the primitive
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    of the language in terms of the primitive operations
    supplied by the machine.  For example, consider how much code is
    compiled to compute
    
      <span style="color:green"><kbd>(+ a 1)</kbd>:</span>
      <span style="color:blue"><kbd>a + 1</kbd>:</span>
    
    The code sets up an argument list in <kbd>argl</kbd>, puts
    the primitive addition
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    (which it finds by looking up the symbol
    
      <span style="color:green"><kbd>+</kbd></span>
      <span style="color:blue"><kbd>"+"</kbd></span>
    
    in the environment) into
    
      <span style="color:green"><kbd>proc</kbd>,</span>
      <span style="color:blue"><kbd>fun</kbd>,</span>
      
    and tests whether the
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    is primitive or compound.  The
    compiler always generates code to perform the test, as well as code
    for primitive and compound branches (only one of which will be executed).
    We have not shown the part of the controller that implements
    primitives, but we presume that these instructions make use of
    primitive arithmetic operations in the machine's data paths.  Consider
    how much less code would be generated if the compiler could
    
    
    <EM>open-code</EM> primitives—that is, if it could generate code to
    directly use these primitive machine operations.  The expression
    
      <span style="color:green"><kbd>(+ a 1)</kbd></span>
      <span style="color:blue"><kbd>a + 1</kbd></span>
    
    might be compiled into something as simple as<a class='superscript' id='footnote-link-2' href='#footnote-2'>[2]</a>
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
(assign val (op lookup-variable-value) (const a) (reg env))
(assign val (op +) (reg val) (const 1))
      </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
assign("val", list(op("lookup_symbol_value"), constant("a"), reg("env"))),
assign("val", list(op("+"), reg("val"), constant(1)))
      </kbd></span></td></tr></table>
    In this exercise we will extend our compiler to support open coding of
    selected primitives.  Special-purpose code will be generated for calls to these primitive
    
      <span style="color:green">procedures</span>
      <span style="color:blue">functions</span>
    
    instead of the general
    
      <span style="color:green">procedure-application</span>
      <span style="color:blue">function-application</span>
    
    code.  In order to support this, we will augment
    our machine with special argument registers
    <kbd>arg1</kbd> and <kbd>arg2</kbd>.
    The primitive arithmetic operations of the machine will take their
    inputs from <kbd>arg1</kbd> and
    <kbd>arg2</kbd>. The results may be put into
    <kbd>val</kbd>, <kbd>arg1</kbd>, or
    <kbd>arg2</kbd>.
    <p></p>
    The compiler must be able to recognize the application of an
    open-coded primitive in the source program.  We will augment the
    dispatch in the <kbd>compile</kbd>
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    to recognize the names of these primitives in addition to the
    
      <span style="color:green">
	
	reserved words (the special forms)
	it currently recognizes.<a class='superscript' id='footnote-link-3' href='#footnote-3'style="color:green">[3]</a>
      </span>
      <span style="color:blue">
	syntactic forms it currently recognizes.
      </span>
    
    For each
    
      <span style="color:green">special</span>
      <span style="color:blue">syntactic</span>
    
    form our compiler has a code
    generator.  In this exercise we will construct a family of code generators
    for the open-coded primitives.
    <OL type="a">
      <LI>
	The open-coded primitives, unlike the
	
	  <span style="color:green">special</span>
	  <span style="color:blue">syntactic</span>
	
	forms, all need their
	
	  <span style="color:green">operands</span>
	  <span style="color:blue">argument expressions</span>
	
	evaluated.  Write a code generator
	
	  <span style="color:green"><kbd>spread-arguments</kbd></span>
	  <span style="color:blue"><kbd>spread_arguments</kbd>
	  </span>
	
	for use by all the open-coding code generators.
	
	  <span style="color:green"><kbd>Spread-arguments</kbd></span>
	  <span style="color:blue">
	    The function
	    <kbd>spread_arguments</kbd>
	  </span>
	
	should take
	
	  <span style="color:green">an operand list</span>
	  <span style="color:blue">a list of argument expressions</span>
	
	and compile the given
	
	  <span style="color:green">operands</span>
	  <span style="color:blue">argument expressions</span>
	
	targeted to
	successive argument registers.  Note that an
	
	  <span style="color:green">operand</span>
	  <span style="color:blue">argument expression</span>
	
	may contain a call
	to an open-coded primitive, so argument registers will have to be
	preserved during
	
	  <span style="color:green">operand</span>
	  <span style="color:blue">argument-expression</span>
	
	evaluation.
      </LI>
      <LI>
	<table width="100%">
        <colgroup><col width="48%"><col width="1%"><col width="51%"></colgroup>
        <tr>
          <td class="meta" style = "color:grey; text-align: center">Original</td>
          <td></td>
          <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
        </tr>
        <tr><td>    </td>
          <td></td>
          <td><span style="color:blue">
	    The JavaScript operators
	    <kbd>===</kbd>,
	    <kbd>*</kbd>,
	    <kbd>-</kbd>, and <kbd>+</kbd>,
	    among others, are implemented in the register machine as
	    primitive functions and are referred to in the global environment
	    with the symbols
	    <kbd>"==="</kbd>,
	    <kbd>"*"</kbd>,
	    <kbd>"-"</kbd>, and
	    <kbd>"+"</kbd>. In JavaScript, it is
	    not possible to redeclare these names, because they do not
	    meet the syntactic restrictions for names. This means it is safe
	    to open-code them.
	  </span></td></tr></table>
	For each of the primitive
	
	  <span style="color:green">procedures</span>
	  <span style="color:blue">functions</span>
	
	
	  <span style="color:green"><kbd>=</kbd>,</span>
	  <span style="color:blue"><kbd>===</kbd>,</span>
	
	<kbd>*</kbd>,
	<kbd>-</kbd>, and <kbd>+</kbd>,
	write a code generator that takes
	
	  <span style="color:green">a combination with that operator,
	  </span>
	  <span style="color:blue">an application with a function expression that
	  names that function,
	  </span>
	
	together with a target and a linkage descriptor, and
	produces code to spread the arguments into the registers and then
	perform the operation targeted to the given target with the given
	linkage.
	
	  <span style="color:green">You need only handle expressions with two operands.</span>
	
	Make <kbd>compile</kbd> dispatch to these code
	generators.
      </LI>
      <LI>
	Try your new compiler on the <kbd>factorial</kbd>
	example.  Compare the resulting code with the result produced without
	open coding.
      </LI>
      <table width="100%">
        <colgroup><col width="48%"><col width="1%"><col width="51%"></colgroup>
        <tr>
          <td class="meta" style = "color:grey; text-align: center">Original</td>
          <td></td>
          <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
        </tr>
        <tr><td><span style="color:green">
	  <LI>
	    Extend your code generators for <kbd>+</kbd> and
	    <kbd>*</kbd> so that they
	    can handle expressions with arbitrary numbers of operands.  An
	    expression with more than two operands will have to be compiled into a
	    sequence of operations, each with only two inputs.
	  </LI>
	</span>    </td>
          <td></td>
          <td></td></tr></table>
    </OL>
  
      <div class="Solution">
      <div class="solution_btn"><button class="btn btn-secondary solution_btn" href="#no_solution_125_6_div" data-toggle="collapse">Add solution</button></div>
      <div class="solution_content collapse" id="no_solution_125_6_div">There is currently no solution available for this exercise. This textbook adaptation is a community effort. Do consider contributing by providing a solution for this exercise, using a Pull Request in <a address="https://github.com/source-academy/sicp" href="https://github.com/source-academy/sicp">Github</a>.</div>
      </div>
    
</EXERCISE></div>

<hr>

    <div class='footnote'><span style="color:blue">
      <a class='footnote-number' id='footnote-1' href='#footnote-link-1' style="color:blue">[1] </a>
    <FOOTNOTE>
    
  Because of the <kbd>append_return_undefined</kbd> in
  <kbd>compile_lambda_body</kbd>, the body actually
  consists of a sequence with two return statements. However, the dead-code check
  in <kbd>compile_sequence</kbd> will stop after the compilation
  of the first return statement,
  so the body effectively consists of only a single return statement.

    </FOOTNOTE></span></div>
    
    
    <div class='footnote'>
      <a class='footnote-number' id='footnote-2' href='#footnote-link-2' >[2] </a>
    <FOOTNOTE>
    We have used
    the same symbol <kbd>+</kbd> here to denote both the
    source-language
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    and the machine operation.  In general there will not be a
    one-to-one correspondence between primitives of the source language
    and primitives of the machine.
    </FOOTNOTE></div>
    
    
    <div class='footnote'><span style="color:green">
      <a class='footnote-number' id='footnote-3' href='#footnote-link-3' style="color:green">[3] </a>
    <FOOTNOTE>
    Making
	the primitives into reserved words is in general a bad idea, since a user
	cannot then rebind these names to different procedures.
	Moreover, if we add reserved words to
	a compiler that is in use, existing programs that define procedures
	with these names will stop working.  See
	exercise&nbsp;<REF NAME="ex:cte-open-code"><a class="superscript" id="5.5.5-ex-link-5.49" href="./5.5.6.html#ex_5.49">5.49</a></REF> for ideas on how to avoid
	this problem.
    </FOOTNOTE></span></div>
    
    
</div></div>

    <div class='nav'>
  
        <a class='btn btn-secondary btn-nav' href='./5.5.4.html'>&lt; Previous</a>
    
    <div style='flex-grow: 1;'></div>
  
        <a class='btn btn-secondary btn-nav' id='127' href='./5.5.6.html'>Next &gt;</a>
      </div>
    <div class='chapter_sign'>
      5.5.5&nbsp;&nbsp;
    An Example of Compiled Code
  
    </div>
    <script> var chapter_id = 126; </script>
    <script> var chapter_path = "chapters/5.5.5.html"; </script>
    <div class='next-page'></div>
    </div>
    </div> <!-- /.container -->
    </body></html>