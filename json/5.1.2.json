[{"id":"/sicpjs/5.1.2","tag":"TITLE","body":"5.1.2  \n    Abstraction in Machine Design"},{"tag":"TEXT","id":"#p1","child":[{"body":"\n    We will often define a machine to include \"","tag":"#text"},{"body":"primitive","tag":"#text"},{"body":"\"\n    operations that are actually very complex.  For example, in\n    sections ","tag":"#text"},{"tag":"REF","body":"5.4","href":"/sicpjs/5.4"},{"body":" and ","tag":"#text"},{"tag":"REF","body":"5.5","href":"/sicpjs/5.5"},{"body":"\n    we will treat\n    JavaScript's\n    environment manipulations as primitive.  Such abstraction is valuable\n    because it allows us to ignore the details of parts of a machine so that we\n    can concentrate on other aspects of the design.  The fact that we have\n    swept a lot of complexity under the rug, however, does not mean that a\n    machine design is unrealistic.  We can always replace the complex\n    \"","tag":"#text"},{"body":"primitives","tag":"#text"},{"body":"\" by simpler primitive operations.\n  ","tag":"#text"}]},{"tag":"TEXT","id":"#p2","child":[{"body":"\n    Consider the GCD machine. The machine has an instruction that computes\n    the remainder of the contents of registers ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"a"},{"body":"\n    and ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"b"},{"body":" and assigns the result to register\n    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"t"},{"body":".  If we want to construct the GCD machine\n    without using a primitive remainder operation, we must specify how to\n    compute remainders in terms of simpler operations, such as subtraction.\n    Indeed, we can write a \n    JavaScript function\n    that finds remainders in this way:\n    ","tag":"#text"},{"tag":"SNIPPET","latex":false,"id":1,"eval":true,"prependLength":0,"program":"chap=4&prgrm=PTAEGUEkGEAVQFLlAVgHQEY0CYBQuAzAVwDsBjAFwEsB7E0AJwFMBbAQypIBMmGAKEgBpQXAJSgA3rlAzGTCkQb16AHhHTZm2QH5QJDVs0AuOe049+9ALQjhYgNy4AvvmZnuvPtgCcwlKPsgA","body":"function remainder(n, d) {\n    return n < d\n           ? n\n           : remainder(n - d, d);\n} "},{"body":"\n\n    We can thus replace the remainder operation in the GCD machine's\n    data paths with a subtraction operation and a comparison test.\n    Figure ","tag":"#text"},{"tag":"REF","body":"5.5","href":"/sicpjs/5.1.2#fig-5.5"},{"body":" shows the data paths and\n    controller for the elaborated machine. The instruction\n    ","tag":"#text"},{"tag":"FIGURE","scale":"30%","src":"img_original/Fig5.5b.std.svg","id":"#fig-5.5","captionHref":"/sicpjs/5.1.2#fig-5.5","captionName":"Figure 5.5 ","captionBody":[{"body":"\n\tData paths and controller for the elaborated GCD  machine.\n      ","tag":"#text"}]},{"tag":"SNIPPET","latex":false,"id":2,"eval":false,"body":"assign(\"t\", list(op(\"rem\"), reg(\"a\"), reg(\"b\")))"},{"body":"\n    in the GCD controller definition is replaced by a sequence of\n    instructions that contains a loop, as shown in\n    figure ","tag":"#text"},{"tag":"REF","body":"5.6","href":"/sicpjs/5.1.2#fig-5.6"},{"body":".\n    ","tag":"#text"},{"tag":"FIGURE","snippet":{"tag":"SNIPPET","latex":false,"id":3,"eval":true,"prependLength":484,"program":"chap=4&prgrm=PTAEGUEkGEAVQFLlAVgHQEY0CYBQuAzAVwDsBjAFwEsB7E0MuigJxoBs2BTZgCgGdOARyKdynAJSgA3gEhcoBaGacKRZvTZU+FHgCJGJFuy7NdAGlADhoshIDcuAL6FSlWvQNGO3APpWRYjyerN7MklLyisqq6qAAFpwAhgAmPBSJVGxBTCEm4uIOzi7k1HSgAOYqPsrlWhTcPAC2iWRxVCScFjU+JImNEtKRCtFq9M2t7Zx6lRTVnLXa3LriPN29-QVO+MQl7qAUAJ4ADlPt2sxEbnThSiqj8UmpZyyXpSQFoEU7Vxo0NADWRCOPiOzCojX4B0aACN2BYaCdmIk3nxwkMGHRtKAAG6JNigAC8oESfD4NDIkJhcNACO4yPcqIciluMXoWh8pGSnAIk1SuLY4nRzMUAH5QNxWLw+FDYWwLLpSP8SDQAO70WlIt6gAC02uJpM4MK4yyFwtAAC4Hik0hksvz8oVtq4tWw-oDgWxEtDOFlPd62HwLH6fT0+gMIsyDFj+YT9WSKcG2KH+kGvT7GeiRrF2ZzubyePbTcKxRKaLxE8nOqAFSQuTyOslQImdXqSQIjZwTWbhZb0pkC3jNl9nXtmv9OCCwY0qNRsRPOAAPYHcniLo4WcZtDqp-2owbMqgEUA8dlR9KGHxr1dL-L77tnhixs+JC9rnz8kTXo6bbss+48SQCQAPgYJlFEccUA04UBD2PdkKyvNdbwje9MQoGCSG0PhY1dAEgR8RMeETQMmzTJM30IpCf27LN6AAwkQOePgwIUCD02g2CTz4OYFnqZhLyXL9kKLDFMPQ5hYxmHi6gaTdJi6eYZP4t8aiE6izVo49AJAqTPFECg+FWD50TYqC7zNUteDXeVFWVNVxSXZRST2Q4ThbONDWhY11M+LZih+UAxwnDV6ToATlwIL8NxaLcq2I+FEVCzC0UjNCaSOHC3Xw0FwR4EK3nCnwESEhK6RRHyH0SHZsKJZojlXBjAsScdJ3BGcqDnQqVyrOTt1I3dxDMETfzNfL3EKkLa0MqiWL-WJ6OA4kjiONgDh8doOVrbhVvacofAAK0SXE+DIMEjh0YaRsUBFovqo9FsiwbiWqh0-O+LU2yocoSFWRTFn49YqzJNRbBSqI7liTRtD0T7vvMW5eN8QGLGB5hQcdd69lhkgeMrHhsfWsSLh+MHhgh+gEmtPssgJ55ibeV7nExsoCY-edBNponXncG5M3Jq1Umpm1+0585ueuRmnV2Mogp8AmV2eaKJj6+L0rKhkLCOMhSdErF0mYGZJKqGolKaGL5LjL6cbWMMTzE17UrEnE8REcLY1Zl32fq54KrStmfB2QkRPZMawqvf2kJEsVZdDnG3xXCOlyV2Kd3TUrNQZQVf0tWWcunWcvcvSLE-XJrlbisiM2ZTSFpAlCrsUARZj0wxDP1mYLH9nYAJ8huUlxMQQQpLXjIbxxHX8j7kgH2wh54EfzMsKoW4M+eyAsIXdKYfTDJHh1QDekcZeaid6m0Iu7e0ZOLdV2OSIIT1yk17XF4fAxknasoiTP5u6A-t5L4UB8pxEOiUCpXnfp-d4OtHZYkgQVQOtUT5FTAeNeOkVLoNywaJf+7hr59Uwdgq6t9UGYl7uDVkWlGr1yIQoJuPgV6GQfokJ+OCoEB1ID3WatD+4vlnlrNeo8iHjxMpBAQi9mSWUAfKaEKR9icCxHTcW9BdQeQ7MsWazhhzS3oD-bItYoE3E0lDHQugf7w3gTzOwvlJ4uQUb-AxACf6EzFiTRemlKaC1tGkexLiXgk2MtogKstoRInIHEC+isy4p36mnUAzDWELxoQ+LkWIiShL4RE1JOgfazRAdxBCglsnCV-A+JimU8IejIkRSuqdyJLgItU4p5CyaUNrhIohnEt6GB3jwBJJTaHdnoYwteFgmItKwaZcRNDBmKF4YPARI9uHCMIeBTRYjoIzMUFIqJuhZGNgyeEjCritSqLbJ5bymjD46NAIc1oNT-RGP5iYvQdy4jw0TB8IJWo3k+GyTwX5Si3E0I8Y8YWWRAVcwCdY65AV2TpHKJUZIBE6jZEaEcOg+kN4JB8AinWml2RHAyLwRg6LMWGEkAAMkpQLNFGKOgUsJASb+OKEUT2ZvQVSgMnmUJeboGo8NuXWO+XsdkJt-rhSEtIOabJuIIqRSi6G1lqwCq+VLAK4q+KFVUkhaVoKqbeJmjYjlutzw6DZjy+4fLnyGHhha4V6qtSnjQi+WYiEbzuP5vClhCqXnKv0C621Q5HV7BtW6hpbMpVSBlbSoWRqRVlEItyvVzzUW6ETIKsMarbFlHgmRSVuro0ErlT6zgyK-VJ2rBm7NJrClVP9FGmNnjwVqQdTm9U9Vk1FtTdDXQCJM0bDbSa0B6sw6CULXzShhLiVSupTBEtiKy2Kp0M2pC8p+3BvbWrDOY7gTFQROFS1sRm1C2bQeqiNaj4dtHXHBpk1kiGXPR67tlChZPu-EOq9TUWrlBoLiv9CsxL4IrruZ+OsUn2Mkn+igf7-m5PRPkxp-pJXNI6QoMpYkapNiyvWn0Dy4l1qQ3h5pyzWn-m0kvBx9RW6jOOQZHyUyOJHi4tJCVV5UNbPQ2lGoRtZiatkubPq-HlINNUiRkSNcKPDO3jRrWFhunUdXjUB24ENlofFMwSU0jqz7IqNBmgdH6Z7DOQadRDHYVal-f+-DAoU28rTVZmDHyyKXpuY52D9ieDub8UZ640rJ33BPd47zQKGaBJDWUDF9VtAtH+Pi-mMWyD-D0FFjRWwTVHCIHwOI-B0hJc7p7eLlDEvJd0Jl7LywBxsBEJuk1ss+BHXnJFKJvUgZ5f+GB1+3H5i8dY3xM25cUbtb8bjQGgCVNkfmhRzjv5ys5ZK-J5eMmlPzAm1g+Z-Dh7a1I8yERTMv2yycjB5QkSgPRItgt0AST0QPh40SKSwmBsxJKyNm2-Rxs+Uk9Q1ZdCls9JozUTWxUStrb7tPPhE5FnbYPmPdlX6Gtzl+uUI9Gg00I87ApZHn6blHbLFMZTdmrVptx8oeGynscBRe88UbtsqdQoZp6yhQX+x05OTzWrB3kGIgIGWRop2r7nZVrU7dSUSLXdgehFoWoiTc953LH4428nMZHTu299Upfs-U5VH4HD6BIJarHLqkUNd0GA0NWZFuiEkJvVXGi-N2nRp+8KE3ONu5CNmRtyHW33eTPWexdTOyzt7LkbL5gjRDPKPcucszVyE30FDxCF3KOmxpoT-DJPFOtQJ-lwA7PoWeaM8C2CoWef6fs7hzc2Wi5OBkCIAgq92nVatYsE7i3cn4mPyG7FhKe4QX81cqce2TKiS6GxroTB0dkHy2a2d5vsSAw97A5g3sxxB-aEAsy6s5iJ-ftPr4wDAu58kPvp3q72tl-7FX+N4fOmwmtHHw3SfLVfkH4oGb+fJ+WFL4bivk41-mUj7uYP5XRP4Tjeav7v6qwjwX4D7-6b66Do7AEjSgF+CNb85v6C5tbd5n5ZxXS-5r5AI378r2J45IG-goEk5NbaZz6XbQE-6X5-4+xEFzY+DNDMDjj8QwZ+DtZkHdgoEsFsEcH-rcGxYXw0Htbf54EMEEEb4j7KBzjMCzAvZcGCFLA76HacAKFKHDYqGJDsG+ArjiHYF0FSGwFMEAHVhp7qFc7cA85h7oGQHC4Ihi7n70GB4C41hKiqhshl5lAD5R6mZeSdgc6V7ILPCAIMI5DGC+D55+Z96UJEpUC8DU7BDRH8SxEkAWAkBEAcDBrDpiSRGGC5AxG+E-RMHxFF7Wjwb7Y3LU7V61715lFD4VGxBCzVFbr0J1ELg1517jTdxRI7A6z0JtFnaDEV4BRAjJDIgThMSAIkRN6Cbhg3ZpRay9aPZz5lZkBpYS4d4sJrF-T9YbEJLbGKAPglaxitZ6AlYnFcZOzOEXGLF6B3w3Exp2GXgxSAKNSdEFH1G9FhTdyt6DKKyAm0JV7dENF9EN4gkW4pFRGhA+bKLjbm6W6DILGDZn7IkolEIJJd75bpSoiDTQl0YZhx675EbkRFEHA2aVhjKYZFb3CJHlj5rIzEkhEBSLgsBS7kmGSpGhAKS2AdRLHVxercTZEcD6JeB5A77KACmI5ilyigDym4EjSWgclIiUDck8CAlCy8l5CYlEJzF1J7iLQzYNwPgdALhupcD9CGCxjNq6ncATINzFrcFggkDlA8AWlWmGj6TKlYkKBigymcCCmGlEmDKMlmwtQISUmekcmXjWlYphn+m0LjL6nJlW6Vz5BJnMiWhBkhkRmyzhFenxk+kUppnplYKpnZnYLEROm-iOBskfSBFcASnFHMDAb0mxBqlcnEStlpHlkomGkf7TbVlmiTHTF+KGRMRGkdk7b+kEqYZzmzINnjFaj1btb0Q0JcDoTnFEjymzTbnxJIj9Cxj7nogZZZYRKqG8AwKKAEDHnQQy4zqXb3lZo7aaS6DJCYq6BXLMgZYHrXmbkiS7m0qvmDoiRgWPn7DeKQUTIflfkdA-kmTnlfpzY8ALi8y-ggURkLi4lxYwq-jwXfm-l3moXFS3kKCIbym5axYDJXRSK6CGjnQHCWDtbuSpYTKMbqY7EwYZREjNog5Ll0JsXfzeKCWEKaS8U7bOC7YoW1EkDtR4hUAABeUwFFrFsWp5ORbA75-Mn5xFyFf5X6H8fARKFA9y-QpILCQpdulCllDWlQzBl5vBIBV2l5TuOcCiDlj58BqWTuYoUWAEHlgUXl1lTl2WrBehHBLlyBblEVgFfp9B9lYVFhZWAFUVahtCAV6V+hN5wVyVjlqV7QilmgqlMV5BGEJVKlalwVUiBVVYnhdknKQgIgWIqi1x5mwplCJlZlrQq5o4XOl5kVuVwhL2hhixeFnWLRdEI5luAhGVUo7WdZI0nuc8SygJe2W6GhWhIhSWwh15YhE1GleJ4uFC5G32c1OVHBNFSWy1v4q1UOPu2Cm1W681I1XBJWm5MafKb1QhH1PBaqJq8h3A2hohuhuVX1xixOmhINu1-w+1C1GixqZFwIgFIOhesQn1aVqNiNeRqFQ1aNS1GN9AWNv1SwjZA1LUj2Xa6Ih5jCsYugAAVKQNjGWozUhUZTcj1ciBZaFZUOpZpPVUQTMOVXwaJIpnwPlXzT5SPk3KLWaGKGzNQuLTvLGGzA6rQqqZpmWE0NLTZCQF4fZMoNYG1XqBoYjKYJ1WdbENzeZXEP1YmjhjwOOAcBvF6FwOBt1owMwI2ESG2OSM7ZwK7dBf2OkEEWti6bmPWGWr9N7ckIlQraAFHbyDAd4jKWWPHRjF+v7RSC7fyRnb3gFtmKKdpbHQXQncWEnVtNHckBfi1XiIHcHc2s2unT7QSRXcyGKC3TXuXRfjnY3W7f2K3Q+pLFugpr0sJp2c1RbdMCoGljUZTn9hLUjkpAVtVjZZNtPabAgXPSsPahZpTROB0CqJFeXEBTsasfrhOI9psS8Q+Akg8VTQcQ0LoMcb7E7CBeubFgBAeSoPsDihkX4C1TYFBWecyIeRQDivcUSC8nysVdQEpapXDfDO0ljfA1QIg8EWtoecJriu7VBbA6nlsWBkGGmscRYP0j5CaniK6GQBOdTVmupohsnQ2PjKSAHSybg2HR7XRSNFw-g7GBGS8iyebabNyoSRWXw8-Zwfg5xWpqadstrbwCyboI0DkdQCtCxXWLyAjEpC8bJYRXpcJsSBwOSNMckBzeBHJQFLhO6H1g0DTaUn7HiO7OwxSJw9I3g+HbpVOtxCwzHYWFlRplpio7ZN4bo-9F2EQpaMznaIOFbQoCar8fUOfahE7OUvdkvb0utb+FRaXeMupV1fcPpYhdJfI4Ql0T0Y0TwM2gUz-RJfzMk2pdJYZaRVzVoL1TlvVepSajFooak1dNJv9qvO3pAzMaUUA9YGIHdZpE0-U-WRJvzELalX0xQPLZXas0FZrSFVZYVfAc8DQwiTrv4CA+s53UvIIMrWM0cwVCc2ILGFYBrdEzs95UQTQ2Y-UPY6YP5SY7Q-Q9I1LbszLdWA9tI2c6KNhpUl84C680VWJIc88T89A3XP-cFEcFhokMtKIILFA+iz3mqts8s-AdcT8yVjCylfAYi0E9c84bVUo7rUC-rYbc1SbehKoq1i8TJdbfQLbX1QfcfC1Jcbg4DCRM4RYA6WEF1k7K1o-UfZwCfZcVQ2WO8fcsK2GI1E7pcaPqY3Q588JpVmqxsC3tgoawoj5FqwcxwCgjbpVs4ea48boJa0mIA3c7YFEyNGw+2EEX2XyZgRHUs4sQ7STfrDoK1lPZgVcSG-PWPcbJ4yMnPqa+G+PTRqCzPQm54+I1nTcvQrg-G0daa2vTVovEM8vam6bOmxbZWE9PvUU7ECU52BPA+OUGQMij6F6GWOY4UZKdwEHLgBK1qQoC8uiGYr4tCOYKaHoi8sVLoASMsJjq8nO6aq6jwAAAz5ASPChvI2bTAtt-Lfn5DlnYx6BrPzuj7LAbsKDEF864RHDjtmiTuorTsAA8i7qkZir78wC7675ZW7hEV7e7iFB7poR777pD0M072oH7Hp77T0b7Y737po7m27-7N757+p-7CFGOwHzk30MMZOn7eyaH2HfAVsC7p7azQHZoSHf7zi8HF7ILu7mH57+ADgMgCgfbaUzbrbfoHb9QyKMrBI6IsslxIkfKiQ8MhH8oFHA5Ke0MfKs7Fg+MFg0IFGiQN+KnMnwofKL7iniQynqnoAT7ty9HI0fKkHun+njUaneoKnJnpxcJJgkzAQtgXmu7bbsImoS6Err0uAObcby2hkXH8Z7bnn-HR1Z7Fg2AK7AAbJsH55WyMkF+57x0uhsWOxYAACxrsOCbNJc8ehen2xSbBlsSqJduf5edsbHicFBAA","body":"controller(\n  list(\n    \"test_b\",\n      test(list(op(\"=\"), reg(\"b\"), constant(0))),\n      branch(label(\"gcd_done\")),\n      assign(\"t\", reg(\"a\")),\n    \"rem_loop\",\n      test(list(op(\"<\"), reg(\"t\"), reg(\"b\"))),\n      branch(label(\"rem_done\")),\n      assign(\"t\", list(op(\"-\"), reg(\"t\"), reg(\"b\"))),\n      go_to(label(\"rem_loop\")),\n    \"rem_done\",\n      assign(\"a\", reg(\"b\")),\n      assign(\"b\", reg(\"t\")),\n      go_to(label(\"test_b\")),\n    \"gcd_done\")) "},"captionHref":"/sicpjs/5.1.2#fig-5.6","captionName":"Figure 5.6 ","captionBody":[{"body":"Controller instruction sequence for the GCD machine in\n      figure ","tag":"#text"},{"tag":"REF","body":"5.5","href":"/sicpjs/5.1.2#fig-5.5"},{"body":".","tag":"#text"}]}]},{"tag":"EXERCISE","title":"Exercise 5.3","id":"#ex-5.3","child":[{"body":"\n    Design a machine to compute\n    \n    square roots using Newton's method, as\n    described in section ","tag":"#text"},{"tag":"REF","body":"1.1.7","href":"/sicpjs/1.1.7"},{"body":" and implemented with the following code in section ","tag":"#text"},{"tag":"REF","body":"1.1.8","href":"/sicpjs/1.1.8"},{"body":":\n    ","tag":"#text"},{"tag":"SNIPPET","latex":false,"id":4,"eval":true,"prependLength":9,"program":"chap=4&prgrm=PTAEGUEkGEAVQFLlAVgHQEY0CYBQuAzAVwDsBjAFwEsB7E0AZwEciBDAJwFMAKADwEpQAb1ygxoLhSLt6vUACpQvANy4AvvmLlqdUKwBundqwDmPXgBpQAT0EjxEzlJmg+oANQ3BYbKo2FSSlp6ZnYKPjtRcS0g3SoGAH0TGhoAEwTOEhoiEwALbhMiTgYGSIcHSWl6AFtWClyE1gAjBm5mNi4CopLBAFolQQAeUAAGNBGRjFUHDQcYnXoqaoAHdhpDLuLS4Sjyx2d6AyNTHkKtqzkwM57p8VnowIXGJjCEqgojTZ6dvbFKl3iSRS6Uy2TyX1Ku1+5QA-KBrgwodDxAAuZ6vd6fJardanbqlfi3MT3P5OKpiUIUN4fdjcDCE9T4SncFCEoA","body":"function sqrt(x) {\n    function is_good_enough(guess) {\n        return math_abs(square(guess) - x) < 0.001;\n    }\n    function improve(guess) {\n        return average(guess, x / guess);\n    }\n    function sqrt_iter(guess) {\n        return is_good_enough(guess)\n               ? guess\n               : sqrt_iter(improve(guess));\n    }\n    return  sqrt_iter(1);\n} "},{"body":"\n    Begin by assuming that\n    ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"is_good_enough"},{"body":"\n    and ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"improve"},{"body":" operations are available as\n    primitives.  Then show how to expand these in terms of arithmetic\n    operations.  Describe each version of the ","tag":"#text"},{"tag":"JAVASCRIPTINLINE","body":"sqrt"},{"body":"\n    machine design by drawing a data-path diagram and writing a controller\n    definition in the register-machine language.\n    ","tag":"#text"}]}]