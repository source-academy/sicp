<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <!-- Global site tag (gtag.js) - Google Analytics - START -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-156801664-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-156801664-1');
    </script>
    <!-- Global site tag (gtag.js) - Google Analytics - END -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="description" content="4.4.2&nbsp;&nbsp;
    How the Query System Works
   - SICP Comparison Edition" />
    <title>
      4.4.2&nbsp;&nbsp;
    How the Query System Works
   - SICP Comparison Edition
    </title>
    
  <meta name="csrf-param" content="authenticity_token" />
  <meta name="csrf-token" content="EMTEijVc2kiiKUH4nYH0lQG3pLPfMowQ/Stg//t6DCo0e5pWMQwamnTvIdmVZqY/MqSx2IYYE+2bpNV6UNSMwQ==" />

    <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata&display?swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Droid+Sans|Droid+Serif" rel="stylesheet">
    <link rel="stylesheet" media="all" href="../assets/stylesheet.css" />

   <link rel="shortcut icon" type="image/x-icon" href="../assets/sourcepower.ico" />

<!--    <link rel="shortcut icon" type="image/png" href="../images/lambda.png" /> -->

    <!-- for support of progressive web app, see github README, DISABLED!
    <link rel="manifest" href="../static/manifest.json">
    -->

    <script src="https://code.jquery.com/jquery-3.2.1.min.js" 
		     	  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
	          crossorigin="anonymous">
    </script> 

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

    <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script> -->
    <script type="text/javascript" 
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-AMS-MML_HTMLorMML-full">
    </script>
   <!--  <script type="text/javascript" 
      src="../MathJax/MathJax.js?config=TeX-AMS-MML_HTMLorMML-full">
    </script> -->
  
    <script src="../assets/application.js"></script>
  
    <!-- Rendering inline LaTeX -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true,
          jax: ["input/TeX","output/HTML-CSS"]
        }
      });
    </script>
    <!--<script src="/mathjax/MathJax.js?config=TeX-AMS_HTML-full.js" type="text/javascript"></script>-->
    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js" type="text/javascript"></script>
    <![endif]-->
  </head>
  <body>

    
    <!-- support for progressive web app, see README, DISABLED
    <script>
      if ('serviceWorker' in navigator && !navigator.serviceWorker.controller) {
          navigator.serviceWorker.register("../sw.js").then(function(reg) {
              console.log("Service worker has been registered for scope: " + reg.scope);
          });
      }
    </script>
    -->

     <nav class="navbar navbar-expand-sm navbar-dark bg-dark fixed-top justify-content-between">
       <button id="btn" class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#nav-sidebar" aria-controls="nav-sidebar" aria-expanded="false" aria-label="Toggle navigation" title="navigation">
         <span class="navbar-toggler-icon"></span>
       </button>
       <span class="toolt">Legend<span class="toolttext">
    <div class="title-text-ALSO">
      <span class="title-text-ALSO">Color highlighting:</span><BR/>
    </div>
    <div class="title-text-OTHEREDITIONS">
      <span class="title-text-OTHEREDITIONS">
      <span style="color:black">Unchanged █</span>
      </span>
    </div>
    <div class="title-text-OTHEREDITIONS">
      <span class="title-text-OTHEREDITIONS">
      <span style="color:green">Scheme █</span>
      </span>
    </div>
    <div class="title-text-OTHEREDITIONS">
      <span class="title-text-OTHEREDITIONS">
      <span style="color:blue">Javascript █</span>
      </span>
    </div>
    <div class="title-text-OTHEREDITIONS">
      <span class="title-text-OTHEREDITIONS">
      <span style="color:grey">Explanation █</span>
      </span>
    </div>
    <div class="title-text-OTHEREDITIONS">
      <span class="title-text-OTHEREDITIONS">
      <span style="color:red">Web-only █</span>
    </div>
</span></span>
       <span class="navbar-brand-short"><a title="Go back to front page" href="../index.html" class="gray">SICP &mdash; Scheme/JS</a></span>
       <span class="navbar-brand-long" ><a title="Go back to front page" href="../index.html" class="gray">Structure and Interpretation of Computer Programs &mdash; Comparison Edition</a></span>

     </nav>
     
     <div class="container scroll">

     
        <div class="collapse" id="nav-sidebar" role="tablist" aria-multiselectable="true">
        <!-- insert a dummy entry, to give one extra line of space -->
        <a class="navbar-brand" href="index.html">&nbsp;</a>
    
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-1">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-1" aria-expanded="false" aria-controls="sidebar-collapse-1">
                <a href="./foreword02.html"> 
        <span style="color:blue">Foreword</span>
    </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-2">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-2" aria-expanded="false" aria-controls="sidebar-collapse-2">
                <a href="./foreword84.html"> Foreword <span style="color:blue">to Structure and Interpretation of Computer Programs, 1984</span></a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-3">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-3" aria-expanded="false" aria-controls="sidebar-collapse-3">
                <a href="./prefaces03.html"> 
    
      <span style="color:blue">Preface</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-4">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-4" aria-expanded="false" aria-controls="sidebar-collapse-4">
                <a href="./prefaces96.html"> 
    Prefaces
    
      <span style="color:blue">
	to Structure and Interpretation of Computer Programs, 1996<span style='color:blue'> & </span>1984
      </span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-5">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-5" aria-expanded="false" aria-controls="sidebar-collapse-5">
                <a href="./acknowledgements.html"> Acknowledgments</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-6">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-6" aria-expanded="false" aria-controls="sidebar-collapse-6">
                <a href="./see.html"> </a>
              </span>
            </h5>
          </div>
        </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-7">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-7" aria-expanded="true" aria-controls="sidebar-collapse-7">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-7" aria-expanded="true" aria-controls="sidebar-collapse-7">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./1.html">1 
    Building Abstractions with 
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
  </a>
                </h5>
              </div>

              <div id="sidebar-collapse-7" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-8">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-8" aria-expanded="true" aria-controls="sidebar-collapse-8">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-8" aria-expanded="true" aria-controls="sidebar-collapse-8">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./1.1.html">1.1 The Elements of Programming</a>
                </h5>
              </div>

              <div id="sidebar-collapse-8" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-9">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-9" aria-expanded="false" aria-controls="sidebar-collapse-9">
                <a href="./1.1.1.html"> 1.1.1 Expressions</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-10">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-10" aria-expanded="false" aria-controls="sidebar-collapse-10">
                <a href="./1.1.2.html"> 1.1.2 Naming and the Environment</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-11">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-11" aria-expanded="false" aria-controls="sidebar-collapse-11">
                <a href="./1.1.3.html"> 1.1.3 
    Evaluating
    
      <span style="color:green">Combinations</span>
      <span style="color:blue">Operator Combinations</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-12">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-12" aria-expanded="false" aria-controls="sidebar-collapse-12">
                <a href="./1.1.4.html"> 1.1.4 
    Compound <span style="color:green">Procedures</span>
    <span style="color:blue">Functions</span>
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-13">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-13" aria-expanded="false" aria-controls="sidebar-collapse-13">
                <a href="./1.1.5.html"> 1.1.5 
    The Substitution Model for 
    
      <span style="color:green">
        Procedure
      </span>
      <span style="color:blue">
        Function
      </span>
    
    Application
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-14">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-14" aria-expanded="false" aria-controls="sidebar-collapse-14">
                <a href="./1.1.6.html"> 1.1.6 
    Conditional Expressions and Predicates
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-15">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-15" aria-expanded="false" aria-controls="sidebar-collapse-15">
                <a href="./1.1.7.html"> 1.1.7 Example: Square Roots by Newton's Method</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-16">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-16" aria-expanded="false" aria-controls="sidebar-collapse-16">
                <a href="./1.1.8.html"> 1.1.8 
    
      <span style="color:green">
        Procedures
      </span>
      <span style="color:blue">
        Functions
      </span>
    
    as Black-Box Abstractions
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-17">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-17" aria-expanded="true" aria-controls="sidebar-collapse-17">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-17" aria-expanded="true" aria-controls="sidebar-collapse-17">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./1.2.html">1.2 
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
    and the Processes They Generate
  </a>
                </h5>
              </div>

              <div id="sidebar-collapse-17" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-18">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-18" aria-expanded="false" aria-controls="sidebar-collapse-18">
                <a href="./1.2.1.html"> 1.2.1 Linear Recursion and Iteration</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-19">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-19" aria-expanded="false" aria-controls="sidebar-collapse-19">
                <a href="./1.2.2.html"> 1.2.2 Tree Recursion</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-20">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-20" aria-expanded="false" aria-controls="sidebar-collapse-20">
                <a href="./1.2.3.html"> 1.2.3 Orders of Growth</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-21">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-21" aria-expanded="false" aria-controls="sidebar-collapse-21">
                <a href="./1.2.4.html"> 1.2.4 Exponentiation</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-22">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-22" aria-expanded="false" aria-controls="sidebar-collapse-22">
                <a href="./1.2.5.html"> 1.2.5 Greatest Common Divisors</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-23">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-23" aria-expanded="false" aria-controls="sidebar-collapse-23">
                <a href="./1.2.6.html"> 1.2.6 Example: Testing for Primality</a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-24">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-24" aria-expanded="true" aria-controls="sidebar-collapse-24">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-24" aria-expanded="true" aria-controls="sidebar-collapse-24">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./1.3.html">1.3 
        Formulating Abstractions with Higher-Order 
        
	  <span style="color:green">Procedures</span>
	  <span style="color:blue">Functions</span>
	
      </a>
                </h5>
              </div>

              <div id="sidebar-collapse-24" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-25">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-25" aria-expanded="false" aria-controls="sidebar-collapse-25">
                <a href="./1.3.1.html"> 1.3.1 
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
    as Arguments
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-26">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-26" aria-expanded="false" aria-controls="sidebar-collapse-26">
                <a href="./1.3.2.html"> 1.3.2 
    
      <span style="color:green">Constructing Procedures using Lambda</span>
      <span style="color:blue">Constructing Functions using Lambda Expressions
      </span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-27">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-27" aria-expanded="false" aria-controls="sidebar-collapse-27">
                <a href="./1.3.3.html"> 1.3.3 
    
      <span style="color:green">Procedures</span>
    <span style="color:blue">Functions</span>
    as General Methods
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-28">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-28" aria-expanded="false" aria-controls="sidebar-collapse-28">
                <a href="./1.3.4.html"> 1.3.4 
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
    as Returned Values
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-29">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-29" aria-expanded="true" aria-controls="sidebar-collapse-29">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-29" aria-expanded="true" aria-controls="sidebar-collapse-29">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.html">2 Building Abstractions with Data</a>
                </h5>
              </div>

              <div id="sidebar-collapse-29" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-30">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-30" aria-expanded="true" aria-controls="sidebar-collapse-30">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-30" aria-expanded="true" aria-controls="sidebar-collapse-30">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.1.html">2.1 Introduction to Data Abstraction</a>
                </h5>
              </div>

              <div id="sidebar-collapse-30" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-31">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-31" aria-expanded="false" aria-controls="sidebar-collapse-31">
                <a href="./2.1.1.html"> 2.1.1 
    Example: Arithmetic Operations for Rational Numbers
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-32">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-32" aria-expanded="false" aria-controls="sidebar-collapse-32">
                <a href="./2.1.2.html"> 2.1.2 
    Abstraction Barriers
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-33">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-33" aria-expanded="false" aria-controls="sidebar-collapse-33">
                <a href="./2.1.3.html"> 2.1.3 
    What Is Meant by Data?
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-34">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-34" aria-expanded="false" aria-controls="sidebar-collapse-34">
                <a href="./2.1.4.html"> 2.1.4 
    Extended Exercise: Interval Arithmetic
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-35">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-35" aria-expanded="true" aria-controls="sidebar-collapse-35">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-35" aria-expanded="true" aria-controls="sidebar-collapse-35">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.2.html">2.2 Hierarchical Data and the Closure Property</a>
                </h5>
              </div>

              <div id="sidebar-collapse-35" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-36">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-36" aria-expanded="false" aria-controls="sidebar-collapse-36">
                <a href="./2.2.1.html"> 2.2.1 
    Representing Sequences
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-37">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-37" aria-expanded="false" aria-controls="sidebar-collapse-37">
                <a href="./2.2.2.html"> 2.2.2 
    Hierarchical Structures
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-38">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-38" aria-expanded="false" aria-controls="sidebar-collapse-38">
                <a href="./2.2.3.html"> 2.2.3 
    Sequences as Conventional Interfaces
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-39">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-39" aria-expanded="false" aria-controls="sidebar-collapse-39">
                <a href="./2.2.4.html"> 2.2.4 
    Example: A Picture Language
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-40">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-40" aria-expanded="true" aria-controls="sidebar-collapse-40">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-40" aria-expanded="true" aria-controls="sidebar-collapse-40">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.3.html">2.3 Symbolic Data</a>
                </h5>
              </div>

              <div id="sidebar-collapse-40" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-41">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-41" aria-expanded="false" aria-controls="sidebar-collapse-41">
                <a href="./2.3.1.html"> 2.3.1 
    
      <span style="color:green">Quotation</span>
      <span style="color:blue">Strings</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-42">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-42" aria-expanded="false" aria-controls="sidebar-collapse-42">
                <a href="./2.3.2.html"> 2.3.2 
    Example: Symbolic Differentiation
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-43">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-43" aria-expanded="false" aria-controls="sidebar-collapse-43">
                <a href="./2.3.3.html"> 2.3.3 
    Example: Representing Sets
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-44">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-44" aria-expanded="false" aria-controls="sidebar-collapse-44">
                <a href="./2.3.4.html"> 2.3.4 
    Example: Huffman Encoding Trees
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-45">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-45" aria-expanded="true" aria-controls="sidebar-collapse-45">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-45" aria-expanded="true" aria-controls="sidebar-collapse-45">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.4.html">2.4 Multiple Representations for Abstract Data</a>
                </h5>
              </div>

              <div id="sidebar-collapse-45" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-46">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-46" aria-expanded="false" aria-controls="sidebar-collapse-46">
                <a href="./2.4.1.html"> 2.4.1 
    Representations for Complex Numbers
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-47">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-47" aria-expanded="false" aria-controls="sidebar-collapse-47">
                <a href="./2.4.2.html"> 2.4.2 
    Tagged data
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-48">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-48" aria-expanded="false" aria-controls="sidebar-collapse-48">
                <a href="./2.4.3.html"> 2.4.3 
    Data-Directed Programming and Additivity
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-49">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-49" aria-expanded="true" aria-controls="sidebar-collapse-49">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-49" aria-expanded="true" aria-controls="sidebar-collapse-49">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./2.5.html">2.5 Systems with Generic Operations</a>
                </h5>
              </div>

              <div id="sidebar-collapse-49" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-50">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-50" aria-expanded="false" aria-controls="sidebar-collapse-50">
                <a href="./2.5.1.html"> 2.5.1 
    Generic Arithmetic Operations
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-51">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-51" aria-expanded="false" aria-controls="sidebar-collapse-51">
                <a href="./2.5.2.html"> 2.5.2 
    Combining Data of Different Types
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-52">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-52" aria-expanded="false" aria-controls="sidebar-collapse-52">
                <a href="./2.5.3.html"> 2.5.3 
    Example: Symbolic Algebra
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-53">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-53" aria-expanded="true" aria-controls="sidebar-collapse-53">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-53" aria-expanded="true" aria-controls="sidebar-collapse-53">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.html">3 Modularity, Objects, and State</a>
                </h5>
              </div>

              <div id="sidebar-collapse-53" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-54">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-54" aria-expanded="true" aria-controls="sidebar-collapse-54">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-54" aria-expanded="true" aria-controls="sidebar-collapse-54">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.1.html">3.1 Assignment and Local State</a>
                </h5>
              </div>

              <div id="sidebar-collapse-54" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-55">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-55" aria-expanded="false" aria-controls="sidebar-collapse-55">
                <a href="./3.1.1.html"> 3.1.1 
    Local State Variables
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-56">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-56" aria-expanded="false" aria-controls="sidebar-collapse-56">
                <a href="./3.1.2.html"> 3.1.2 
    The Benefits of Introducing Assignment
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-57">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-57" aria-expanded="false" aria-controls="sidebar-collapse-57">
                <a href="./3.1.3.html"> 3.1.3 
    The Costs of Introducing Assignment
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-58">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-58" aria-expanded="true" aria-controls="sidebar-collapse-58">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-58" aria-expanded="true" aria-controls="sidebar-collapse-58">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.2.html">3.2 The Environment Model of Evaluation</a>
                </h5>
              </div>

              <div id="sidebar-collapse-58" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-59">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-59" aria-expanded="false" aria-controls="sidebar-collapse-59">
                <a href="./3.2.1.html"> 3.2.1 
    The Rules for Evaluation
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-60">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-60" aria-expanded="false" aria-controls="sidebar-collapse-60">
                <a href="./3.2.2.html"> 3.2.2 
    Applying Simple
    
      <span style="color:green">Procedures</span>
      <span style="color:blue">Functions</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-61">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-61" aria-expanded="false" aria-controls="sidebar-collapse-61">
                <a href="./3.2.3.html"> 3.2.3 
    Frames as the Repository of Local State
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-62">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-62" aria-expanded="false" aria-controls="sidebar-collapse-62">
                <a href="./3.2.4.html"> 3.2.4 
    Internal
    
      <span style="color:green">Definitions</span>
      <span style="color:blue">Declarations</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-63">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-63" aria-expanded="false" aria-controls="sidebar-collapse-63">
                <a href="./3.2.5.html"> 3.2.5 
    CSE Machine
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-64">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-64" aria-expanded="true" aria-controls="sidebar-collapse-64">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-64" aria-expanded="true" aria-controls="sidebar-collapse-64">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.3.html">3.3 Modeling with Mutable Data</a>
                </h5>
              </div>

              <div id="sidebar-collapse-64" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-65">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-65" aria-expanded="false" aria-controls="sidebar-collapse-65">
                <a href="./3.3.1.html"> 3.3.1 
    Mutable List Structure
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-66">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-66" aria-expanded="false" aria-controls="sidebar-collapse-66">
                <a href="./3.3.2.html"> 3.3.2 
    Representing Queues
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-67">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-67" aria-expanded="false" aria-controls="sidebar-collapse-67">
                <a href="./3.3.3.html"> 3.3.3 
    Representing Tables
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-68">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-68" aria-expanded="false" aria-controls="sidebar-collapse-68">
                <a href="./3.3.4.html"> 3.3.4 
    A Simulator for Digital Circuits
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-69">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-69" aria-expanded="false" aria-controls="sidebar-collapse-69">
                <a href="./3.3.5.html"> 3.3.5 
    Propagation of Constraints
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-70">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-70" aria-expanded="true" aria-controls="sidebar-collapse-70">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-70" aria-expanded="true" aria-controls="sidebar-collapse-70">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.4.html">3.4 Concurrency: Time Is of the Essence</a>
                </h5>
              </div>

              <div id="sidebar-collapse-70" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-71">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-71" aria-expanded="false" aria-controls="sidebar-collapse-71">
                <a href="./3.4.1.html"> 3.4.1 
    The Nature of Time in Concurrent Systems
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-72">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-72" aria-expanded="false" aria-controls="sidebar-collapse-72">
                <a href="./3.4.2.html"> 3.4.2 
    Mechanisms for Controlling Concurrency
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-73">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-73" aria-expanded="true" aria-controls="sidebar-collapse-73">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-73" aria-expanded="true" aria-controls="sidebar-collapse-73">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./3.5.html">3.5 Streams</a>
                </h5>
              </div>

              <div id="sidebar-collapse-73" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-74">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-74" aria-expanded="false" aria-controls="sidebar-collapse-74">
                <a href="./3.5.1.html"> 3.5.1 
    Streams Are Delayed Lists
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-75">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-75" aria-expanded="false" aria-controls="sidebar-collapse-75">
                <a href="./3.5.2.html"> 3.5.2 
    Infinite Streams
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-76">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-76" aria-expanded="false" aria-controls="sidebar-collapse-76">
                <a href="./3.5.3.html"> 3.5.3 
    Exploiting the Stream Paradigm
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-77">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-77" aria-expanded="false" aria-controls="sidebar-collapse-77">
                <a href="./3.5.4.html"> 3.5.4 
    Streams and Delayed Evaluation
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-78">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-78" aria-expanded="false" aria-controls="sidebar-collapse-78">
                <a href="./3.5.5.html"> 3.5.5 
    Modularity of Functional Programs and Modularity of Objects
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-79">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-79" aria-expanded="true" aria-controls="sidebar-collapse-79">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-79" aria-expanded="true" aria-controls="sidebar-collapse-79">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.html">4 Metalinguistic Abstraction</a>
                </h5>
              </div>

              <div id="sidebar-collapse-79" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-80">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-80" aria-expanded="true" aria-controls="sidebar-collapse-80">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-80" aria-expanded="true" aria-controls="sidebar-collapse-80">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.1.html">4.1 The Metacircular Evaluator</a>
                </h5>
              </div>

              <div id="sidebar-collapse-80" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-81">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-81" aria-expanded="false" aria-controls="sidebar-collapse-81">
                <a href="./4.1.1.html"> 4.1.1 
    The Core of the Evaluator
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-82">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-82" aria-expanded="false" aria-controls="sidebar-collapse-82">
                <a href="./4.1.2.html"> 4.1.2 
    Representing
    
      <span style="color:green">Expressions</span>
      <span style="color:blue">Components</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-83">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-83" aria-expanded="false" aria-controls="sidebar-collapse-83">
                <a href="./4.1.3.html"> 4.1.3 
    Evaluator Data Structures
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-84">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-84" aria-expanded="false" aria-controls="sidebar-collapse-84">
                <a href="./4.1.4.html"> 4.1.4 
    Running the Evaluator as a Program
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-85">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-85" aria-expanded="false" aria-controls="sidebar-collapse-85">
                <a href="./4.1.5.html"> 4.1.5 
    Data as Programs
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-86">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-86" aria-expanded="false" aria-controls="sidebar-collapse-86">
                <a href="./4.1.6.html"> 4.1.6 
    Internal
    
      <span style="color:green">Definitions</span>
      <span style="color:blue">Declarations</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-87">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-87" aria-expanded="false" aria-controls="sidebar-collapse-87">
                <a href="./4.1.7.html"> 4.1.7 
    Separating Syntactic Analysis from Execution
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-88">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-88" aria-expanded="true" aria-controls="sidebar-collapse-88">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-88" aria-expanded="true" aria-controls="sidebar-collapse-88">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.2.html">4.2 
    
      <span style="color:green">Variations on a Scheme:</span>
    
    Lazy Evaluation
</a>
                </h5>
              </div>

              <div id="sidebar-collapse-88" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-89">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-89" aria-expanded="false" aria-controls="sidebar-collapse-89">
                <a href="./4.2.1.html"> 4.2.1 
    Normal Order and Applicative Order
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-90">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-90" aria-expanded="false" aria-controls="sidebar-collapse-90">
                <a href="./4.2.2.html"> 4.2.2 
    An Interpreter with Lazy Evaluation
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-91">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-91" aria-expanded="false" aria-controls="sidebar-collapse-91">
                <a href="./4.2.3.html"> 4.2.3 
    Streams as Lazy Lists
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-92">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-92" aria-expanded="true" aria-controls="sidebar-collapse-92">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-92" aria-expanded="true" aria-controls="sidebar-collapse-92">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.3.html">4.3 
    
      <span style="color:green">Variations on a Scheme:</span>
    
    Nondeterministic Computing
  </a>
                </h5>
              </div>

              <div id="sidebar-collapse-92" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-93">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-93" aria-expanded="false" aria-controls="sidebar-collapse-93">
                <a href="./4.3.1.html"> 4.3.1 
    
      <span style="color:green">Amb and Search</span>
      <span style="color:blue">Search and amb</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-94">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-94" aria-expanded="false" aria-controls="sidebar-collapse-94">
                <a href="./4.3.2.html"> 4.3.2 
    Examples of Nondeterministic Programs
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-95">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-95" aria-expanded="false" aria-controls="sidebar-collapse-95">
                <a href="./4.3.3.html"> 4.3.3 
    Implementing the
    
      <span style="color:green">Amb</span>
      <span style="color:blue">amb</span>
    
    Evaluator
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-96">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-96" aria-expanded="true" aria-controls="sidebar-collapse-96">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-96" aria-expanded="true" aria-controls="sidebar-collapse-96">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./4.4.html">4.4 Logic Programming</a>
                </h5>
              </div>

              <div id="sidebar-collapse-96" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-97">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-97" aria-expanded="false" aria-controls="sidebar-collapse-97">
                <a href="./4.4.1.html"> 4.4.1 
    Deductive Information Retrieval
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-98">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-98" aria-expanded="false" aria-controls="sidebar-collapse-98">
                <a href="./4.4.2.html"> 4.4.2 
    How the Query System Works
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-99">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-99" aria-expanded="false" aria-controls="sidebar-collapse-99">
                <a href="./4.4.3.html"> 4.4.3 
    Is Logic Programming Mathematical Logic?
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-100">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-100" aria-expanded="false" aria-controls="sidebar-collapse-100">
                <a href="./4.4.4.html"> 4.4.4 
    Implementing the Query System
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-101">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-101" aria-expanded="true" aria-controls="sidebar-collapse-101">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-101" aria-expanded="true" aria-controls="sidebar-collapse-101">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.html">5 Computing with Register Machines</a>
                </h5>
              </div>

              <div id="sidebar-collapse-101" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-102">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-102" aria-expanded="true" aria-controls="sidebar-collapse-102">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-102" aria-expanded="true" aria-controls="sidebar-collapse-102">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.1.html">5.1 Designing Register Machines</a>
                </h5>
              </div>

              <div id="sidebar-collapse-102" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-103">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-103" aria-expanded="false" aria-controls="sidebar-collapse-103">
                <a href="./5.1.1.html"> 5.1.1 
    A Language for Describing Register Machines
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-104">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-104" aria-expanded="false" aria-controls="sidebar-collapse-104">
                <a href="./5.1.2.html"> 5.1.2 
    Abstraction in Machine Design
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-105">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-105" aria-expanded="false" aria-controls="sidebar-collapse-105">
                <a href="./5.1.3.html"> 5.1.3 
    Subroutines
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-106">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-106" aria-expanded="false" aria-controls="sidebar-collapse-106">
                <a href="./5.1.4.html"> 5.1.4 
    Using a Stack to Implement Recursion
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-107">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-107" aria-expanded="false" aria-controls="sidebar-collapse-107">
                <a href="./5.1.5.html"> 5.1.5 
    Instruction Summary
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-108">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-108" aria-expanded="true" aria-controls="sidebar-collapse-108">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-108" aria-expanded="true" aria-controls="sidebar-collapse-108">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.2.html">5.2 A Register-Machine Simulator</a>
                </h5>
              </div>

              <div id="sidebar-collapse-108" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-109">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-109" aria-expanded="false" aria-controls="sidebar-collapse-109">
                <a href="./5.2.1.html"> 5.2.1 
    The Machine Model
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-110">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-110" aria-expanded="false" aria-controls="sidebar-collapse-110">
                <a href="./5.2.2.html"> 5.2.2 
    The Assembler
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-111">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-111" aria-expanded="false" aria-controls="sidebar-collapse-111">
                <a href="./5.2.3.html"> 5.2.3 
    
      <span style="color:green">Generating Execution Procedures for Instructions</span>
      <span style="color:blue">Instructions and Their Execution Functions</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-112">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-112" aria-expanded="false" aria-controls="sidebar-collapse-112">
                <a href="./5.2.4.html"> 5.2.4 
    Monitoring Machine Performance
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-113">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-113" aria-expanded="true" aria-controls="sidebar-collapse-113">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-113" aria-expanded="true" aria-controls="sidebar-collapse-113">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.3.html">5.3 Storage Allocation and Garbage Collection</a>
                </h5>
              </div>

              <div id="sidebar-collapse-113" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-114">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-114" aria-expanded="false" aria-controls="sidebar-collapse-114">
                <a href="./5.3.1.html"> 5.3.1 
    Memory as Vectors
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-115">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-115" aria-expanded="false" aria-controls="sidebar-collapse-115">
                <a href="./5.3.2.html"> 5.3.2 
    Maintaining the Illusion of Infinite Memory
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-116">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-116" aria-expanded="true" aria-controls="sidebar-collapse-116">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-116" aria-expanded="true" aria-controls="sidebar-collapse-116">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.4.html">5.4 The Explicit-Control Evaluator</a>
                </h5>
              </div>

              <div id="sidebar-collapse-116" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-117">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-117" aria-expanded="false" aria-controls="sidebar-collapse-117">
                <a href="./5.4.1.html"> 5.4.1 
    
      <span style="color:green">The Core of the Explicit-Control Evaluator</span>
      <span style="color:blue">The Dispatcher and Basic Evaluation</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-118">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-118" aria-expanded="false" aria-controls="sidebar-collapse-118">
                <a href="./5.4.2.html"> 5.4.2 
    
      <span style="color:green">
        Sequence Evaluation and Tail Recursion
      </span>
      <span style="color:blue">
        Evaluating Function Applications
      </span>
        
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-119">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-119" aria-expanded="false" aria-controls="sidebar-collapse-119">
                <a href="./5.4.3.html"> 5.4.3 
    
      <span style="color:green">
        Conditionals, Assignments and Definitions
      </span>
      <span style="color:blue">
        Blocks, Assignments, and Declarations
      </span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-120">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-120" aria-expanded="false" aria-controls="sidebar-collapse-120">
                <a href="./5.4.4.html"> 5.4.4 
    Running the Evaluator
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
            <div class="card card-inverse">
              <div class="card-header" role="tab" id="sidebar-121">
                <h5 class="mb-0">
                  <a class="sidebar-show collapsed" data-toggle="collapse" href="#sidebar-collapse-121" aria-expanded="true" aria-controls="sidebar-collapse-121">
                  &#10148;   <!-- ➤ (because this one is rendered blue on mobile: ▶  -->
                  </a>
                  <a class="sidebar-hide collapsed" data-toggle="collapse" href="#sidebar-collapse-121" aria-expanded="true" aria-controls="sidebar-collapse-121">
                  &#x25BC;    <!-- ▼ (because the corresponding one is not rendered) -->
                  </a>
                  <a href="./5.5.html">5.5 Compilation</a>
                </h5>
              </div>

              <div id="sidebar-collapse-121" class="collapse" role="tabpanel" aria-labelledby="headingOne">
                <div class="card-block">
            
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-122">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-122" aria-expanded="false" aria-controls="sidebar-collapse-122">
                <a href="./5.5.1.html"> 5.5.1 
    Structure of the Compiler
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-123">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-123" aria-expanded="false" aria-controls="sidebar-collapse-123">
                <a href="./5.5.2.html"> 5.5.2 
    Compiling
    
      <span style="color:green">Expressions</span>
      <span style="color:blue">Components</span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-124">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-124" aria-expanded="false" aria-controls="sidebar-collapse-124">
                <a href="./5.5.3.html"> 5.5.3 
    Compiling
    
      <span style="color:green">
	Combinations
      </span>
      <span style="color:blue">
	Applications and Return Statements
      </span>
    
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-125">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-125" aria-expanded="false" aria-controls="sidebar-collapse-125">
                <a href="./5.5.4.html"> 5.5.4 
    Combining Instruction Sequences
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-126">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-126" aria-expanded="false" aria-controls="sidebar-collapse-126">
                <a href="./5.5.5.html"> 5.5.5 
    An Example of Compiled Code
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-127">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-127" aria-expanded="false" aria-controls="sidebar-collapse-127">
                <a href="./5.5.6.html"> 5.5.6 
    Lexical Addressing
  </a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-128">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-128" aria-expanded="false" aria-controls="sidebar-collapse-128">
                <a href="./5.5.7.html"> 5.5.7 
    Interfacing Compiled Code to the Evaluator
  </a>
              </span>
            </h5>
          </div>
        </div>
        
                </div>
              </div>
            </div>
        
                </div>
              </div>
            </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-129">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-129" aria-expanded="false" aria-controls="sidebar-collapse-129">
                <a href="./references.html"> References</a>
              </span>
            </h5>
          </div>
        </div>
        
        <div class="card card-inverse">
          <div class="card-header" role="tab" id="sidebar-130">
            <h5 class="mb-0">
              <span class="collapsed" data-toggle="collapse" href="#sidebar-collapse-130" aria-expanded="false" aria-controls="sidebar-collapse-130">
                <a href="./making-of.html"> <span class='webonly'>About the SICP JS Project</span></a>
              </span>
            </h5>
          </div>
        </div>
        </div>
<div id='permalink-msg'>
<div class='screen'>
  <div class='alert alert-success'>
    <strong>Permalink copied!</strong>
  </div>
</div>
</div>
<div class='chapter-content'>

      <div class='chapter-title'>
        <div class='permalink'>
        <a name='top' class='permalink'> 
    4.4.2&nbsp;&nbsp;
    How the Query System Works
  
        </a>
        </div>
      </div>
      <div class='chapter-text'>
        <div class='SECTION'>
    

  

  

  <div class='permalink'>
<a name='p1' class='permalink'></a><p>
    In section&nbsp;<REF NAME="sec:implementing-the-query-system"><a class="superscript" id="4.4.2-sec-link-4.4.4" href="./4.4.4.html">4.4.4</a></REF> we will
    present an implementation of the query interpreter as a collection of
    
      <span style="color:green">procedures.</span>
      <span style="color:blue">functions.</span>
    
    In this section we give an overview that explains the general
    structure of the system independent of low-level implementation
    details.  After describing the implementation of the interpreter, we
    will be in a position to understand some of its limitations and some
    of the subtle ways in which the query language's logical operations
    differ from the operations of mathematical logic.
  </p></div>

  <div class='permalink'>
<a name='p2' class='permalink'></a><p>
    It should be apparent that the query evaluator must perform some kind
    of search in order to match queries against facts and rules in the
    data base.  One way to do this would be to implement the query system
    as a nondeterministic program, using the <kbd>amb</kbd>
    evaluator of section&nbsp;<REF NAME="sec:nondeterministic-evaluation"><a class="superscript" id="4.4.2-sec-link-4.3" href="./4.3.html">4.3</a></REF>
    (see exercise&nbsp;<REF NAME="ex:query-lang-amb"><a class="superscript" id="4.4.2-ex-link-4.89" href="./4.4.4.html#ex_4.89">4.89</a></REF>).  Another possibility
    is to manage the search with the aid of streams.  Our implementation follows
    this second approach.
  </p></div>

  <div class='permalink'>
<a name='p3' class='permalink'></a><p>
    The query system is organized around two central operations, called
    <EM>pattern matching</EM> and <EM>unification</EM>.  We first describe
    pattern matching and explain how this operation, together with the
    organization of information in terms of streams of frames, enables us
    to implement both simple and compound queries.  We next discuss
    unification, a generalization of pattern matching needed to implement
    rules.  Finally, we show how the entire query interpreter fits
    together through a
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    that classifies
    
      <span style="color:green">expressions</span>
      <span style="color:blue">queries</span>
    
    in a manner analogous to the way
    
      <span style="color:green">
	<kbd>eval</kbd>
      </span>
      <span style="color:blue">
	<kbd>evaluate</kbd>
      </span>
    
    classifies expressions for the interpreter described in
    section&nbsp;<REF NAME="sec:mc-eval"><a class="superscript" id="4.4.2-sec-link-4.1" href="./4.1.html">4.1</a></REF>.
  </p></div>

  
      <div class='permalink'>
        <a name='h1' class='permalink'></a><h2>
    
    Pattern matching
  </h2></div>

  
  

  <div class='permalink'>
<a name='p4' class='permalink'></a><p>
    A <EM>pattern matcher</EM> is a program that tests whether some datum
    fits a specified pattern.  For example, the 
    
      <span style="color:green">
	data list
	<kbd>((a b) c (a b))</kbd>
      </span>
      <span style="color:blue">
	datum
	<kbd>list(list("a", "b"), "c", list("a", "b"))</kbd>
      </span>
    
    matches the pattern
    
      <span style="color:green"><kbd>(?x c ?x)</kbd></span>
      <span style="color:blue"><kbd>list($x, "c", $x)</kbd>
      </span>
    
    with the pattern variable
    
      <span style="color:green"><kbd>?x</kbd></span>
      <span style="color:blue"><kbd>$x</kbd></span>
    
    bound to
    
      <span style="color:green"><kbd>(a b)</kbd>.</span>
      <span style="color:blue"><kbd>list("a", "b")</kbd>.
    </span>
    The same
    
      <span style="color:green">
	data list
      </span>
      <span style="color:blue">
	data list
      </span>
    
    matches the pattern
    
      <span style="color:green"><kbd>(?x ?y ?z)</kbd></span>
      <span style="color:blue"><kbd>list($x, $y, $z)</kbd>
      </span>
    
    with
    
      <span style="color:green"><kbd>?x</kbd></span>
      <span style="color:blue"><kbd>$x</kbd></span>
    
    and
    
      <span style="color:green"><kbd>?z</kbd></span>
      <span style="color:blue"><kbd>$z</kbd></span>
    
    both bound to
    
      <span style="color:green"><kbd>(a b)</kbd></span>
      <span style="color:blue"><kbd>list("a", "b")</kbd>
      </span>
    
    and
    
      <span style="color:green"><kbd>?y</kbd></span>
      <span style="color:blue"><kbd>$y</kbd></span>
    
    bound to
    
      <span style="color:green"><kbd>c</kbd>.</span>
      <span style="color:blue"><kbd>"c"</kbd>.</span>
    
    It also matches the pattern
    
      <span style="color:green">
      <kbd>((?x ?y) c (?x ?y))</kbd></span>
      <span style="color:blue">
	<kbd>list(list($x, $y), "c", list($x, $y))</kbd>
      </span>
    
    with
    
      <span style="color:green"><kbd>?x</kbd></span>
      <span style="color:blue"><kbd>$x</kbd></span>
    
    bound to
    
      <span style="color:green"><kbd>a</kbd></span>
      <span style="color:blue"><kbd>"a"</kbd></span>
    
    and
    
      <span style="color:green"><kbd>?y</kbd></span>
      <span style="color:blue"><kbd>$y</kbd></span>
    
    bound to
    
      <span style="color:green"><kbd>b</kbd>.</span>
      <span style="color:blue"><kbd>"b"</kbd>.</span>
    
    However, it does not match the pattern
    
      <span style="color:green"><kbd>(?x a ?y)</kbd>,</span>
      <span style="color:blue"><kbd>list($x, "a", $y)</kbd>,
      </span>
    since that pattern specifies a list whose second element is the
    
      <span style="color:green">symbol <kbd>a</kbd>.</span>
      <span style="color:blue">string <kbd>"a"</kbd>.</span>
    
  </p></div>

  <div class='permalink'>
<a name='p5' class='permalink'></a><p>
    The pattern matcher used by the query system takes as inputs a
    pattern, a datum, and a
    
    
    <EM>frame</EM> that specifies bindings for
    various pattern variables.  It checks whether the datum matches the
    pattern in a way that is consistent with the bindings already in the
    frame.  If so, it returns the given frame augmented by any bindings
    that may have been determined by the match.  Otherwise, it indicates
    that the match has failed.
  </p></div>

  <div class='permalink'>
<a name='p6' class='permalink'></a><p>
    
      <span style="color:green">
	For example, using the pattern
      </span>
      <span style="color:blue">
	Using the pattern
      </span>
    
    
      <span style="color:green"><kbd>(?x ?y ?x)</kbd></span>
      <span style="color:blue"><kbd>list($x, $y, $x)</kbd>
      </span>
    
    to match
    
      <span style="color:green"><kbd>(a b a)</kbd></span>
      <span style="color:blue"><kbd>list("a", "b", "a")</kbd>
      </span>
    
    
      <span style="color:green">
	given an empty frame
      </span>
      <span style="color:blue">
	given an empty frame, for example,
      </span>
    
    will return a frame specifying that
    
      <span style="color:green"><kbd>?x</kbd></span>
      <span style="color:blue"><kbd>$x</kbd></span>
    
    is bound to
    
      <span style="color:green"><kbd>a</kbd></span>
      <span style="color:blue"><kbd>"a"</kbd></span>
    
    and
    
      <span style="color:green"><kbd>?y</kbd></span>
      <span style="color:blue"><kbd>$y</kbd></span>
    
    is bound to
    
      <span style="color:green"><kbd>b</kbd>.</span>
      <span style="color:blue"><kbd>"b"</kbd>.</span>
    
    Trying the match with the same pattern, the same datum, and a frame
    specifying that
    
      <span style="color:green"><kbd>?y</kbd></span>
      <span style="color:blue"><kbd>$y</kbd></span>
    
    is bound to
    
      <span style="color:green"><kbd>a</kbd></span>
      <span style="color:blue"><kbd>"a"</kbd></span>
    
    will fail.  Trying the match with the same pattern, the same datum, and a
    frame in which
    
      <span style="color:green"><kbd>?y</kbd></span>
      <span style="color:blue"><kbd>$y</kbd></span>
    
    is bound to
    
      <span style="color:green"><kbd>b</kbd></span>
      <span style="color:blue"><kbd>"b"</kbd></span>
    
    and
    
      <span style="color:green"><kbd>?x</kbd></span>
      <span style="color:blue"><kbd>$x</kbd></span>
    
    is unbound will return the given frame augmented by a binding of
    
      <span style="color:green"><kbd>?x</kbd></span>
      <span style="color:blue"><kbd>$x</kbd></span>
    
    to&nbsp;<span style="color:green"><kbd>a</kbd>.</span><span style="color:blue"><kbd>"a"</kbd>.</span>
  </p></div>

  <div class='permalink'>
<a name='p7' class='permalink'></a><p>
    The pattern matcher is all the mechanism that is needed to process
    
    simple
    queries that don't involve rules.  For instance, to process the query
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
(job ?x (computer programmer))
      </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
	job($x, list("computer", "programmer"))
      </kbd></span></td></tr></table>
    we scan through all assertions in the data base and select those that
    match the pattern with respect to an initially empty frame.  For each
    match we find, we use the frame returned by the match to instantiate
    the pattern with a value for
    
      <span style="color:green"><kbd>?x</kbd>.</span>
      <span style="color:blue"><kbd>$x</kbd>.</span>
    
  </p></div>

  
  

  
      <div class='permalink'>
        <a name='h2' class='permalink'></a><h2>
    
    Streams of frames
  </h2></div>

  <div class='permalink'>
<a name='p8' class='permalink'></a><p>
    The testing of patterns against frames is organized through the use of
    
    
    streams.  Given a single frame, the matching process runs through the
    data-base entries one by one.  For each data-base entry, the matcher
    generates either a special symbol indicating that the match has failed
    or an extension to the frame.  The results for all the data-base
    entries are collected into a stream, which is passed through a filter
    to weed out the failures.  The result is a stream of all the frames
    that extend the given frame via a match to some assertion in the data
    base.<a class='superscript' id='footnote-link-1' href='#footnote-1'>[1]</a>
  </p></div>

  <div class='permalink'>
<a name='p9' class='permalink'></a><p>
    In our system, a query takes an input stream of frames and performs
    the above matching operation for every frame in the stream, as
    indicated in
    
      <span style="color:green">
	figure&nbsp;<REF NAME="fig:query-stream_scheme"><a class="superscript" id="4.4.2-fig-link-4.7" href="./4.4.2.html#fig_4.7">4.7</a></REF>.
      </span>
      <span style="color:blue">
	figure&nbsp;<REF NAME="fig:query-stream"><a class="superscript" id="4.4.2-fig-link-4.8" href="./4.4.2.html#fig_4.8">4.8</a></REF>.
      </span>
    
    That is, for
    each frame in the input stream, the query generates a new stream consisting
    of all extensions to that frame by matches to assertions in the data base.
    All these streams are then combined to form one huge stream, which contains
    all possible extensions of every frame in the input stream. This stream is
    the output of the query.
    <table width="100%">
        <colgroup><col width="48%"><col width="1%"><col width="51%"></colgroup>
        <tr>
          <td class="meta" style = "color:grey; text-align: center">Original</td>
          <td></td>
          <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
        </tr>
        <tr><td><span style="color:green">
	<FIGURE>
      <img style="width: 100%" id="fig_4.7" src="../img_original/Fig4.4a.std.svg">
      <div class="chapter-text-CAPTION">
      <b><a class="caption" href="./4.4.2.html#fig_4.7">Figure 4.7 </a></b>A query processes a stream of frames.</div></FIGURE>
      </span>    </td>
          <td></td>
          <td><span style="color:blue">
	<FIGURE>
      <img style="width: 100%" id="fig_4.8" src="../img_javascript/Fig4.4a.std.svg">
      <div class="chapter-text-CAPTION">
      <b><a class="caption" href="./4.4.2.html#fig_4.8">Figure 4.8 </a></b>A query processes a stream of frames.</div></FIGURE>
      </span></td></tr></table>
  </p></div>

  <div class='permalink'>
<a name='p10' class='permalink'></a><p>
    To answer a
    
    simple query, we use the query with an input stream
    consisting of a single empty frame.  The resulting output stream
    contains all extensions to the empty frame (that is, all answers to
    our query).  This stream of frames is then used to generate a stream
    of copies of the original query pattern with the variables
    instantiated by the values in each frame, and this is the stream that
    is finally printed.
  </p></div>

  
      <div class='permalink'>
        <a name='h3' class='permalink'></a><h2>
    
    Compound queries
  </h2></div>

  

  <div class='permalink'>
<a name='p11' class='permalink'></a><p>
    The real elegance of the stream-of-frames implementation is evident
    when we deal with compound queries.  The processing of compound
    queries makes use of the ability of our matcher to demand that a match
    be consistent with a specified frame.  For example, to handle the
    
    <kbd>and</kbd> of two queries, such as
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
(and (can-do-job ?x (computer programmer trainee))
     (job ?person ?x))
      </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
and(can_do_job($x, list("computer", "programmer", "trainee")),
    job($person, $x))
      </kbd></span></td></tr></table>
    (informally, <QUOTE>Find all people who can do the job of a computer
    programmer trainee</QUOTE>), we first find all entries that match the
    pattern
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
(can-do-job ?x (computer programmer trainee))
      </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
can_do_job($x, list("computer", "programmer", "trainee"))
      </kbd></span></td></tr></table>
    This produces a stream of frames, each of which contains a binding for
    
      <span style="color:green"><kbd>?x</kbd>.</span>
      <span style="color:blue"><kbd>$x</kbd>.</span>
    
    Then for each frame in the stream we find all entries that
    match
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
(job ?person ?x)
      </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
job($person, $x)
      </kbd></span></td></tr></table>
    in a way that is consistent with the given binding for
    
      <span style="color:green"><kbd>?x</kbd>.</span>
      <span style="color:blue"><kbd>$x</kbd>.</span>
    
    Each such match will produce a frame containing bindings for
    
      <span style="color:green"><kbd>?x</kbd></span>
      <span style="color:blue"><kbd>$x</kbd></span>
    
    and
    
      <span style="color:green"><kbd>?person</kbd>.</span>
      <span style="color:blue"><kbd>$person</kbd>.</span>
    
    The <kbd>and</kbd> of two queries can be viewed as a series
    combination of the two component queries, as shown in
    
      <span style="color:green">
	figure&nbsp;<REF NAME="fig:query-and_scheme"><a class="superscript" id="4.4.2-fig-link-4.9" href="./4.4.2.html#fig_4.9">4.9</a></REF>.
      </span>
      <span style="color:blue">
	figure&nbsp;<REF NAME="fig:query-and"><a class="superscript" id="4.4.2-fig-link-4.10" href="./4.4.2.html#fig_4.10">4.10</a></REF>.
      </span>
    
    The frames that pass through the
    first query filter are filtered and further extended by the second query.
    <table width="100%">
        <colgroup><col width="48%"><col width="1%"><col width="51%"></colgroup>
        <tr>
          <td class="meta" style = "color:grey; text-align: center">Original</td>
          <td></td>
          <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
        </tr>
        <tr><td><span style="color:green">
	<FIGURE>
      <img style="width: 100%" id="fig_4.9" src="../img_original/Fig4.5a.std.svg">
      <div class="chapter-text-CAPTION">
      <b><a class="caption" href="./4.4.2.html#fig_4.9">Figure 4.9 </a></b>
	    The <kbd>and</kbd> combination of two queries is
            produced by operating on the stream of frames in series.
	  </div></FIGURE>
      </span>    </td>
          <td></td>
          <td><span style="color:blue">
	<FIGURE>
      <img style="width: 100%" id="fig_4.10" src="../img_javascript/Fig4.5a.std.svg">
      <div class="chapter-text-CAPTION">
      <b><a class="caption" href="./4.4.2.html#fig_4.10">Figure 4.10 </a></b>
	    The <kbd>and</kbd> combination of two queries is
            produced by operating on the stream of frames in series.
	  </div></FIGURE>
      </span></td></tr></table>
    
  </p></div>

  <div class='permalink'>
<a name='p12' class='permalink'></a><p>
    
      <span style="color:green">
    Figure&nbsp;<REF NAME="fig:query-or_scheme"><a class="superscript" id="4.4.2-fig-link-4.11" href="./4.4.2.html#fig_4.11">4.11</a></REF>
      </span>
      <span style="color:blue">
    Figure&nbsp;<REF NAME="fig:query-or"><a class="superscript" id="4.4.2-fig-link-4.12" href="./4.4.2.html#fig_4.12">4.12</a></REF>
      </span>
    
    shows the analogous method for
    computing the
    
    <kbd>or</kbd> of two queries as a parallel
    combination of the two component queries.  The input stream of frames is
    extended separately by each query.  The two resulting streams are then
    merged to produce the final output stream.

    <table width="100%">
        <colgroup><col width="48%"><col width="1%"><col width="51%"></colgroup>
        <tr>
          <td class="meta" style = "color:grey; text-align: center">Original</td>
          <td></td>
          <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
        </tr>
        <tr><td><span style="color:green">
	<FIGURE>
      <img style="width: 100%" id="fig_4.11" src="../img_original/Fig4.6a.std.svg">
      <div class="chapter-text-CAPTION">
      <b><a class="caption" href="./4.4.2.html#fig_4.11">Figure 4.11 </a></b>
	    The <kbd>or</kbd> combination of two queries is
	    produced by operating on the stream of frames in parallel and
	    merging the results.
	  </div></FIGURE>
      </span>    </td>
          <td></td>
          <td><span style="color:blue">
	<FIGURE>
      <img style="width: 100%" id="fig_4.12" src="../img_javascript/Fig4.6a.std.svg">
      <div class="chapter-text-CAPTION">
      <b><a class="caption" href="./4.4.2.html#fig_4.12">Figure 4.12 </a></b>
	    The <kbd>or</kbd> combination of two
	    queries is produced by operating on the stream of frames in parallel
	    and merging the results.
	  </div></FIGURE>
      </span></td></tr></table>

  </p></div>

  
  <div class='permalink'>
<a name='p13' class='permalink'></a><p>
    Even from this high-level description, it is apparent that the
    processing of compound queries can be slow.
    
    For example, since a query may produce more than one output frame for each
    input frame, and each query in an <kbd>and</kbd> gets its
    input frames from the previous query, an <kbd>and</kbd>
    query could, in the worst case, have to perform a number of matches that is
    exponential in the number of queries (see 
    exercise&nbsp;<REF NAME="ex:q-exponential-and"><a class="superscript" id="4.4.2-ex-link-4.87" href="./4.4.4.html#ex_4.87">4.87</a></REF>).<a class='superscript' id='footnote-link-2' href='#footnote-2'>[2]</a>
    Though systems for handling only simple queries are quite practical, dealing
    with complex queries is extremely difficult.<a class='superscript' id='footnote-link-3' href='#footnote-3'>[3]</a>
  </p></div>

  <div class='permalink'>
<a name='p14' class='permalink'></a><p>
    From the stream-of-frames viewpoint, the
    
    <kbd>not</kbd> of
    some query acts as a filter that removes all frames for which the query can
    be satisfied.  For instance, given the pattern
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
(not (job ?x (computer programmer)))
      </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
not(job($x, list("computer", "programmer")))
      </kbd></span></td></tr></table>
    we attempt, for each frame in the input stream, to produce extension
    frames that satisfy
    
      <span style="color:green">
	<kbd>(job ?x (computer programmer))</kbd>.
      </span>
      <span style="color:blue">
	<kbd>job($x, list("computer", "programmer"))</kbd>.
      </span>
    
    We remove from the input stream all frames for which such extensions exist.
    The result is a stream consisting of only those frames in which the binding
    for
    
      <span style="color:green"><kbd>?x</kbd></span>
      <span style="color:blue"><kbd>$x</kbd></span>
    
    does not satisfy
    
      <span style="color:green"><kbd>(job ?x (computer programmer))</kbd>.
      </span>
      <span style="color:blue">
	<kbd>job($x, list("computer", "programmer"))</kbd>.
      </span>
    
    For example, in processing the query
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
(and (supervisor ?x ?y)
     (not (job ?x (computer programmer))))
      </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
and(supervisor($x, $y),
    not(job($x, list("computer", "programmer"))))
      </kbd></span></td></tr></table>
    the first clause will generate frames with bindings for
    
      <span style="color:green"><kbd>?x</kbd></span>
      <span style="color:blue"><kbd>$x</kbd></span>
    
    and
    
      <span style="color:green"><kbd>?y</kbd>.</span>
      <span style="color:blue"><kbd>$y</kbd>.</span>
    
    The <kbd>not</kbd> clause will then filter these by
    removing all frames in which the binding for
    
      <span style="color:green"><kbd>?x</kbd></span>
      <span style="color:blue"><kbd>$x</kbd></span>
    
    satisfies the restriction that
    
      <span style="color:green"><kbd>?x</kbd></span>
      <span style="color:blue"><kbd>$x</kbd></span>
    
    is a computer programmer.<a class='superscript' id='footnote-link-4' href='#footnote-4'>[4]</a>
  </p></div>

  <div class='permalink'>
<a name='p15' class='permalink'></a><p>
    The
    
    
      <span style="color:green">
	<kbd>lisp-value</kbd>
	special	form
      </span>
      <span style="color:blue">
	<kbd>javascript_predicate</kbd>
	syntactic form
      </span>
    
    is implemented as a similar filter on frame streams.  We use each frame in
    the stream to instantiate any variables in the pattern, then apply the
    
      <span style="color:green">Lisp</span>
      <span style="color:blue">JavaScript</span>
    
    predicate.  We remove from the input stream all frames for which the
    predicate fails.
  </p></div>

  
  
  
      <div class='permalink'>
        <a name='h4' class='permalink'></a><h2>
    
    Unification
  </h2></div>

  
  

  <div class='permalink'>
<a name='p16' class='permalink'></a><p>
    In order to handle rules in the query language, we must be able to
    find the rules whose conclusions match a given query pattern.  Rule
    conclusions are like assertions except that they can contain
    variables, so we will need a generalization of pattern
    matching—called <EM>unification</EM>—in which both the
    <QUOTE>pattern</QUOTE> and the <QUOTE>datum</QUOTE> may contain variables.
  </p></div>

  
  <div class='permalink'>
<a name='p17' class='permalink'></a><p>
    A unifier takes two patterns, each containing constants and variables,
    and determines whether it is possible to assign values to the
    variables that will make the two patterns equal.  If so, it returns a
    frame containing these bindings.  For example, unifying
    
      <span style="color:green"><kbd>(?x a ?y)</kbd></span>
      <span style="color:blue"><kbd>list($x, "a", $y)</kbd>
      </span>
    
    and
    
      <span style="color:green"><kbd>(?y ?z a)</kbd></span>
      <span style="color:blue"><kbd>list($y, $z, "a")</kbd>
      </span>
    
    will specify a frame in which
    
      <span style="color:green"><kbd>?x</kbd>,</span>
      <span style="color:blue"><kbd>$x</kbd>,</span>
    
    
      <span style="color:green"><kbd>?y</kbd>,</span>
      <span style="color:blue"><kbd>$y</kbd>,</span>
    
    and
    
      <span style="color:green"><kbd>?z</kbd></span>
      <span style="color:blue"><kbd>$z</kbd></span>
    
    must all be bound to
    
      <span style="color:green"><kbd>a</kbd>.</span>
      <span style="color:blue"><kbd>"a"</kbd>.</span>
    
    On the other hand, unifying
    
      <span style="color:green"><kbd>(?x ?y a)</kbd></span>
      <span style="color:blue"><kbd>list($x, $y, "a")</kbd>
      </span>
    
    and
    
      <span style="color:green"><kbd>(?x b ?y)</kbd></span>
      <span style="color:blue"><kbd>list($x, "b", $y)</kbd>
      </span>
    
    will fail, because there is no value for
    
      <span style="color:green"><kbd>?y</kbd></span>
      <span style="color:blue"><kbd>$y</kbd></span>
    
    that can make the two patterns equal. (For the second elements of the
    patterns to be equal,
    
      <span style="color:green"><kbd>?y</kbd></span>
      <span style="color:blue"><kbd>$y</kbd></span>
    
    would have to be
    
      <span style="color:green"><kbd>b</kbd>;</span>
      <span style="color:blue"><kbd>"b"</kbd>;</span>
    
    however, for the third elements to be equal,
    
      <span style="color:green"><kbd>?y</kbd></span>
      <span style="color:blue"><kbd>$y</kbd></span>
    
    would have to be
    <span style="color:green"><kbd>a</kbd>.)</span>
    <span style="color:blue"><kbd>"a"</kbd>.)</span>
    
    The unifier used in the query system, like the pattern matcher, takes a
    frame as input and performs unifications that are consistent with this frame.
  </p></div>

  <div class='permalink'>
<a name='p18' class='permalink'></a><p>
    The unification algorithm is the most technically difficult part of
    the query system.  With complex patterns, performing unification may
    seem to require deduction.
    To unify
    
      <span style="color:green"><kbd>(?x ?x)</kbd></span>
      <span style="color:blue">
	<span style="color:blue"><kbd class='snippet'>
	    list($x, $x)
	  </kbd></span>
      </span>
    
    and
    
      <span style="color:green"><kbd>((a ?y c) (a b ?z))</kbd>,</span>
      <span style="color:blue">
	<span style="color:blue"><kbd class='snippet'>
list(list("a", $y, "c"), list("a", "b", $z))
	  </kbd></span>
      </span>
    
    for example,
    the algorithm must infer that
    
      <span style="color:green"><kbd>?x</kbd></span>
      <span style="color:blue"><kbd>$x</kbd></span>
    
    should be
    
      <span style="color:green"><kbd>(a b c)</kbd>,</span>
      <span style="color:blue"><kbd>list("a", "b", "c")</kbd>,
      </span>
    
    
      <span style="color:green"><kbd>?y</kbd></span>
      <span style="color:blue"><kbd>$y</kbd></span>
    
    should be
    
      <span style="color:green"><kbd>b</kbd>,</span>
      <span style="color:blue"><kbd>"b"</kbd>,</span>
    
    and
    
      <span style="color:green"><kbd>?z</kbd></span>
      <span style="color:blue"><kbd>$z</kbd></span>
    
    should be
    
      <span style="color:green"><kbd>c</kbd>.</span>
      <span style="color:blue"><kbd>"c"</kbd>.</span>
    
    We may think of this process as solving a set of equations among the pattern
    components.  In general, these are simultaneous equations, which may require
    substantial manipulation to solve.<a class='superscript' id='footnote-link-5' href='#footnote-5'>[5]</a>  For example,
    unifying
    
      <span style="color:green"><kbd>(?x ?x)</kbd></span>
      <span style="color:blue"><kbd>list($x, $x)</kbd></span>
    
    and
    
      <span style="color:green"><kbd>((a ?y c) (a b ?z))</kbd></span>
      <span style="color:blue">
	<kbd>list(list("a", $y, "c"), list("a", "b", $z))</kbd>
      </span>
    
    may be thought of as specifying the simultaneous equations
    <table width="100%">
        <colgroup><col width="48%"><col width="1%"><col width="51%"></colgroup>
        <tr>
          <td class="meta" style = "color:grey; text-align: center">Original</td>
          <td></td>
          <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
        </tr>
        <tr><td><span style="color:green">
	
	  \[\begin{array}{lll}
	  \texttt{?x} & = & \texttt{(a ?y c)} \\
	  \texttt{?x} & = & \texttt{(a b ?z)}
	  \end{array}\]
	
      </span>    </td>
          <td></td>
          <td><span style="color:blue">
	
	  \[\begin{array}{lll}
	  \texttt{\$x} & = & \texttt{list("a", \$y, "c")} \\
	  \texttt{\$x} & = & \texttt{list("a", "b", \$z)} \\
	  \end{array}\]
	
      </span></td></tr></table>
    These equations imply that
    <table width="100%">
        <colgroup><col width="48%"><col width="1%"><col width="51%"></colgroup>
        <tr>
          <td class="meta" style = "color:grey; text-align: center">Original</td>
          <td></td>
          <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
        </tr>
        <tr><td><span style="color:green">
	
	  \[ (a ?y c) =  (a b ?z) \]
	
      </span>    </td>
          <td></td>
          <td><span style="color:blue">
	
	  \[\begin{array}{lll}
	  \texttt{list("a", \$y, "c")} & = &  \texttt{list("a", "b", \$z)}
	  \end{array}\]
	
      </span></td></tr></table>
    which in turn implies that
    <table width="100%">
        <colgroup><col width="48%"><col width="1%"><col width="51%"></colgroup>
        <tr>
          <td class="meta" style = "color:grey; text-align: center">Original</td>
          <td></td>
          <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
        </tr>
        <tr><td><span style="color:green">
	
	  \[ \texttt{a} =  \texttt{a},\ 
             \texttt{?y} = \texttt{b},\ 
	     \texttt{c} = \texttt{?z} \]
	
      </span>    </td>
          <td></td>
          <td><span style="color:blue">
	
	  \[\begin{array}{lllllll}
	  \texttt{"a"} & = & \texttt{"a"},\qquad
             \texttt{\$y} & = & \texttt{"b"},\qquad
             \texttt{"c"} & = & \texttt{\$z}
	     \end{array}\]
	
      </span></td></tr></table>
    and hence that
    <table width="100%">
        <colgroup><col width="48%"><col width="1%"><col width="51%"></colgroup>
        <tr>
          <td class="meta" style = "color:grey; text-align: center">Original</td>
          <td></td>
          <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
        </tr>
        <tr><td><span style="color:green">
	
	  \[\begin{array}{lll}
	  \texttt{?x} & = & \texttt{(a b c)}
	  \end{array}\]
	
      </span>    </td>
          <td></td>
          <td><span style="color:blue">
	
	  \[\begin{array}{lll}
	  \texttt{\$x} & = & \texttt{list("a", "b", "c")}
	  \end{array}\]
	
      </span></td></tr></table>
  </p></div>

  <div class='permalink'>
<a name='p19' class='permalink'></a><p>
    In a successful pattern match, all pattern variables become bound, and
    the values to which they are bound contain only constants.  This is
    also true of all the examples of unification we have seen so far.
    
    
    In general, however, a successful unification may not completely
    determine the variable values; some variables may remain unbound and
    others may be bound to values that contain variables.
  </p></div>

  
  <div class='permalink'>
<a name='p20' class='permalink'></a><p>
    Consider the unification of
    
      <span style="color:green"><kbd>(?x a)</kbd></span>
      <span style="color:blue"><kbd>list($x, "a")</kbd></span>
    
    and
    
      <span style="color:green"><kbd>((b ?y) ?z)</kbd>.</span>
      <span style="color:blue"><kbd>list(list("b", $y), $z)</kbd>.
    </span>
    We can deduce that
    
      <span style="color:green"><kbd>?x</kbd></span>
      <span style="color:blue"><kbd>$x</kbd></span>
    
    $=$
    
      <span style="color:green"><kbd>(b ?y)</kbd></span>
      <span style="color:blue"><kbd>list("b", $y)</kbd></span>
    
    and
    
      <span style="color:green"><kbd>a</kbd></span>
      <span style="color:blue"><kbd>"a"</kbd></span>
    
    $=$
    
      <span style="color:green"><kbd>?z</kbd>,</span>
      <span style="color:blue"><kbd>$z</kbd>,</span>
    
    but we cannot further solve for
    
      <span style="color:green"><kbd>?x</kbd></span>
      <span style="color:blue"><kbd>$x</kbd></span>
    
    or
    
      <span style="color:green"><kbd>?y</kbd>.</span>
      <span style="color:blue"><kbd>$y</kbd>.</span>
    
    The unification doesn't fail, since it is certainly possible to make
    the two patterns equal by assigning values to
    
      <span style="color:green"><kbd>?x</kbd></span>
      <span style="color:blue"><kbd>$x</kbd></span>
    
    and
    
      <span style="color:green"><kbd>?y</kbd>.</span>
      <span style="color:blue"><kbd>$y</kbd>.</span>
    
    Since this match in no way restricts the values
    
      <span style="color:green"><kbd>?y</kbd></span>
      <span style="color:blue"><kbd>$y</kbd></span>
    
    can take on, no binding for
    
      <span style="color:green"><kbd>?y</kbd></span>
      <span style="color:blue"><kbd>$y</kbd></span>
    
    is put into the result frame. The match does, however, restrict the value of
    
      <span style="color:green"><kbd>?x</kbd>.</span>
      <span style="color:blue"><kbd>$x</kbd>.</span>
    
    Whatever value
    
      <span style="color:green"><kbd>?y</kbd></span>
      <span style="color:blue"><kbd>$y</kbd></span>
    
    has,
    
      <span style="color:green"><kbd>?x</kbd></span>
      <span style="color:blue"><kbd>$x</kbd></span>
    
    must be
    
      <span style="color:green"><kbd>(b ?y)</kbd>.</span>
      <span style="color:blue"><kbd>list("b", $y)</kbd>.
      </span>
    
    A binding of
    
      <span style="color:green"><kbd>?x</kbd></span>
      <span style="color:blue"><kbd>$x</kbd></span>
    
    to the pattern
    
      <span style="color:green"><kbd>(b ?y)</kbd></span>
      <span style="color:blue"><kbd>list("b", $y)</kbd></span>
    
    is thus put into the frame.  If a value for
    
      <span style="color:green"><kbd>?y</kbd></span>
      <span style="color:blue"><kbd>$y</kbd></span>
    
    is later determined and added to the frame (by a pattern match or
    unification that is required to be consistent with this frame), the
    previously bound
    
      <span style="color:green"><kbd>?x</kbd></span>
      <span style="color:blue"><kbd>$x</kbd></span>
    
    will refer to this value.<a class='superscript' id='footnote-link-6' href='#footnote-6'>[6]</a>
  </p></div>

  
  
  
  
      <div class='permalink'>
        <a name='h5' class='permalink'></a><h2>
    
    Applying rules
  </h2></div>

  

  <div class='permalink'>
<a name='p21' class='permalink'></a><p>
    Unification is the key to the component of the query system that makes
    inferences from rules. To see how this is accomplished, consider
    processing a query that involves applying a rule, such as
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
(lives-near ?x (Hacker Alyssa P))
      </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
lives_near($x, list("Hacker", "Alyssa", "P"))
      </kbd></span></td></tr></table>
    To process this query, we first use the ordinary pattern-match
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    described above to see if there are any assertions in the data base that
    match this pattern.  (There will not be any in this case, since our data
    base includes no direct assertions about who lives near whom.)  The next
    step is to attempt to unify the query pattern with the conclusion of each
    rule.  We find that the pattern unifies with the conclusion of the rule
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
(rule (lives-near ?person-1 ?person-2)
      (and (address ?person-1 (?town . ?rest-1))
           (address ?person-2 (?town . ?rest-2))
           (not (same ?person-1 ?person-2))))
      </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
rule(lives_near($person_1, $person_2),
     and(address($person_1, pair($town, $rest_1)),
         address($person_2, list($town, $rest_2)),
         not(same($person_1, $person_2))))
      </kbd></span></td></tr></table>
    resulting in a frame specifying that
    
      <span style="color:green">
	<kbd>?person-2</kbd>
	is bound to
	<kbd>(Hacker Alyssa P)</kbd>
	and that
	<kbd>?x</kbd>
	should be bound to (have the same value as)
	<kbd>?person-1</kbd>.
      </span>
      <span style="color:blue">
	<kbd>$x</kbd>
	should be bound to (have the same value as)
	<kbd>$person_1</kbd>
	and that
	<kbd>$person_2</kbd>
	is bound to
	<kbd>list("Hacker", "Alyssa", "P")</kbd>.
      </span>
    
    Now, relative to this frame, we evaluate the compound query given by the body
    of the rule.  Successful matches will extend this frame by providing a
    binding for
    
      <span style="color:green"><kbd>?person-1</kbd>,</span>
      <span style="color:blue"><kbd>$person_1</kbd>,</span>
    
    and consequently a value for
    
      <span style="color:green"><kbd>?x</kbd>,</span>
      <span style="color:blue"><kbd>$x</kbd>,</span>
    
    which we can use to instantiate the original query pattern.
  </p></div>

  <div class='permalink'>
<a name='p22' class='permalink'></a><p>
    In general, the query evaluator uses the following method to apply a
    rule when trying to establish a query pattern in a frame that
    specifies bindings for some of the pattern variables:

    <UL>
      <LI>
	Unify the query with the conclusion of the rule to form, if
	successful, an extension of the original frame.
      </LI>
      <LI>
	Relative to the extended frame, evaluate the query formed by
	the body of the rule.
      </LI>
    </UL>
  </p></div>

  
  <div class='permalink'>
<a name='p23' class='permalink'></a><p>
    Notice how similar this is to the method for applying a
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    in the
    
    
      <span style="color:green"><kbd>eval/apply</kbd></span>
      <span style="color:blue"><kbd>evaluate</kbd>/<kbd>apply</kbd>
      </span>
    
    evaluator for
    
      <span style="color:green">Lisp:</span>
      <span style="color:blue">JavaScript:</span>
    
    <UL>
      <LI>
	Bind the
	
	  <span style="color:green">procedure's</span>
	  <span style="color:blue">function's</span>
	
	parameters to its arguments to form a frame that extends the original
	
	  <span style="color:green">procedure</span>
	  <span style="color:blue">function</span>
	
	environment.
      </LI>
      <LI>
	Relative to the extended environment, evaluate the expression
	formed by the body of the
	
	  <span style="color:green">procedure.</span>
	  <span style="color:blue">function.</span>
	
      </LI>
    </UL>
    The similarity between the two evaluators should come as no surprise.
    Just as
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    definitions are the means of abstraction in
    
      <span style="color:green">Lisp,</span>
      <span style="color:blue">JavaScript,</span>
    
    rule definitions are the means of abstraction in the query language.
    In each case, we unwind the abstraction by creating appropriate
    bindings and evaluating the rule or
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    body relative to these.
  </p></div>

  
  
  
      <div class='permalink'>
        <a name='h6' class='permalink'></a><h2>
    
    Simple queries
  </h2></div>

  

  <div class='permalink'>
<a name='p24' class='permalink'></a><p>
    We saw earlier in this section how to evaluate simple queries in the
    absence of rules.  Now that we have seen how to apply rules, we can
    describe how to evaluate simple queries by using both rules and
    assertions.
  </p></div>

  <div class='permalink'>
<a name='p25' class='permalink'></a><p>
    Given the query pattern and a stream of frames, we produce, for each
    frame in the input stream, two streams:
    <UL>
      <LI>a stream of extended frames obtained by matching the pattern
      against all assertions in the data base (using the pattern matcher),
      and

      </LI>
      <LI>a stream of extended frames obtained by applying all
      possible rules (using the unifier).<a class='superscript' id='footnote-link-7' href='#footnote-7'>[7]</a>
      </LI>
    </UL>
    Appending these two streams produces a stream that consists of all the
    ways that the given pattern can be satisfied consistent with the
    original frame.  These streams (one for each frame in the input
    stream) are now all combined to form one large stream, which therefore
    consists of all the ways that any of the frames in the original input
    stream can be extended to produce a match with the given pattern.
  </p></div>

  
  
  
      <div class='permalink'>
        <a name='h7' class='permalink'></a><h2>
    
    The query evaluator and the driver loop
  </h2></div>

  <div class='permalink'>
<a name='p26' class='permalink'></a><p>
    Despite the complexity of the underlying matching operations, the
    system is organized much like an
    
    
    evaluator for any language.  The
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    that coordinates the matching operations is called 
     
    
      <span style="color:green"><kbd>qeval</kbd>,</span>
      <span style="color:blue"><kbd>evaluate_query</kbd>,
      </span>
    
    and it plays a role analogous to that of the
    
      <span style="color:green"><kbd>eval</kbd></span>
      <span style="color:blue"><kbd>evaluate</kbd></span>
    
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    for
    
      <span style="color:green">Lisp.</span>
      <span style="color:blue">JavaScript.</span>
    
    
      <span style="color:green"><kbd>Qeval</kbd></span>
      <span style="color:blue">The function
      <kbd>evaluate_query</kbd>
      </span>
    
    takes as inputs a query and a stream of frames.  Its output is a stream of
    frames, corresponding to successful matches to the query pattern, that
    extend some frame in the input stream, as indicated in
    
      <span style="color:green">
	figure&nbsp;<REF NAME="fig:query-stream_scheme"><a class="superscript" id="4.4.2-fig-link-4.7" href="./4.4.2.html#fig_4.7">4.7</a></REF>.
      </span>
      <span style="color:blue">
	figure&nbsp;<REF NAME="fig:query-stream"><a class="superscript" id="4.4.2-fig-link-4.8" href="./4.4.2.html#fig_4.8">4.8</a></REF>.
      </span>
    
    Like
    
      <span style="color:green"><kbd>eval</kbd>,</span>
      <span style="color:blue"><kbd>evaluate</kbd>,</span>
    
    
      <span style="color:green"><kbd>qeval</kbd></span>
      <span style="color:blue"><kbd>evaluate_query</kbd>
      </span>
    
    classifies the different types of expressions (queries) and dispatches to an
    appropriate
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    for each.  There is a
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    for each
    
      <span style="color:green">special</span>
      <span style="color:blue">syntactic</span>
    
    form
    (<kbd>and</kbd>, <kbd>or</kbd>,
    <kbd>not</kbd>, and
    
      <span style="color:green">
	<kbd>lisp-value</kbd>)
      </span>
      <span style="color:blue">
	<kbd>javascript_predicate</kbd>)
      </span>
    
    and one for simple queries.
    <span class='comment'>
      We use the more verbose name
      <kbd>evaluate_query</kbd> rather than
      <kbd>qeval</kbd> because we were forced
      to use <kbd>evaluate</kbd> instead of
      <kbd>eval</kbd> in section 4.1.
    </span>
  </p></div>

  <div class='permalink'>
<a name='p27' class='permalink'></a><p>
    The
    
    
    driver loop, which is analogous to the
    
      <span style="color:green">
	<kbd>driver-loop</kbd>
      </span>
      <span style="color:blue">
	<kbd>driver_loop</kbd>
      </span>
    
    
      <span style="color:green">procedure</span>
      <span style="color:blue">function</span>
    
    for the other evaluators in this chapter, reads queries
    
      <span style="color:green">from the terminal.</span>
      <span style="color:blue">typed by the user.</span>
    
    For each query, it calls
    
      <span style="color:green"><kbd>qeval</kbd></span>
      <span style="color:blue"><kbd>evaluate_query</kbd>
      </span>
    
    with the query and a stream that consists of a single empty frame.  This
    will produce the stream of all possible matches (all possible extensions to
    the empty frame).  For each frame in the resulting stream, it instantiates
    the original query using the values of the variables found in the frame.
    This stream of instantiated queries is then printed.<a class='superscript' id='footnote-link-8' href='#footnote-8'>[8]</a>
  </p></div>

  <div class='permalink'>
<a name='p28' class='permalink'></a><p>
    The driver also checks for the special command
    
    
    
      <span style="color:green"><kbd>assert!</kbd>,</span>
      <span style="color:blue"><kbd>assert</kbd>,</span>
    
    which signals that the input is not a query but rather an assertion or rule
    to be added to the data base.  For instance,
    <table width="100%">
          <colgroup><col width="48%"><col width="52%"></colgroup>
          
          <tr>
            <td class="meta" style = "color:grey; text-align: center">Original</td>
            <td class="meta" style = "color:grey; text-align: center">JavaScript</td>
          </tr>
          <tr>
            <td><span style="color:green"><span style="color:green"><kbd class='snippet'>
(assert! (job (Bitdiddle Ben) (computer wizard)))

(assert! (rule (wheel ?person)
         (and (supervisor ?middle-manager ?person)
              (supervisor ?x ?middle-manager))))
      </kbd></span></span>    </td>
            <td><span style="color:blue"><kbd class='snippet'>
assert(job(list("Bitdiddle", "Ben"), list("computer", "wizard")))

assert(rule(wheel($person),
            and(supervisor($middle_manager, $person),
                supervisor($x, $middle_manager))))
      </kbd></span></td></tr></table>
  </p></div>


<hr>

    <div class='footnote'>
      <a class='footnote-number' id='footnote-1' href='#footnote-link-1' >[1] </a>
    <FOOTNOTE>
    Because matching is generally very
    
    expensive, we would
    like to avoid applying the full matcher to every element of the data
    base.  This is usually arranged by breaking up the process into a
    fast, coarse match and the final match.  The coarse match filters the
    data base to produce a small set of candidates for the final match.
    With care, we can arrange our data base so that some of the work of
    coarse matching can be done when the data base is constructed rather
    then when we want to select the candidates.  This is called
    
    
    <EM>indexing</EM> the data base.  There is a vast technology built around
    data-base-indexing schemes.  Our implementation, described in
    section&nbsp;<REF NAME="sec:implementing-the-query-system"><a class="superscript" id="4.4.2-sec-link-4.4.4" href="./4.4.4.html">4.4.4</a></REF>, contains a
    simpleminded form of such an optimization.
    </FOOTNOTE></div>
    
    
    <div class='footnote'>
      <a class='footnote-number' id='footnote-2' href='#footnote-link-2' >[2] </a>
    <FOOTNOTE>
    But this kind
    of exponential explosion is not common in <kbd>and</kbd>
    queries because the added conditions tend to reduce rather than expand
    the number of frames produced.
    </FOOTNOTE></div>
    
    
    <div class='footnote'>
      <a class='footnote-number' id='footnote-3' href='#footnote-link-3' >[3] </a>
    <FOOTNOTE>
    There is a large
    literature on data-base-management systems that is concerned with how to
    handle complex queries efficiently.
    </FOOTNOTE></div>
    
    
    <div class='footnote'>
      <a class='footnote-number' id='footnote-4' href='#footnote-link-4' >[4] </a>
    <FOOTNOTE>
    There is a subtle difference between this
    filter implementation of <kbd>not</kbd> and the usual
    meaning of <kbd>not</kbd> in mathematical logic.  See
    section&nbsp;<REF NAME="sec:math-logic"><a class="superscript" id="4.4.2-sec-link-4.4.3" href="./4.4.3.html">4.4.3</a></REF>.
    </FOOTNOTE></div>
    
    
    <div class='footnote'>
      <a class='footnote-number' id='footnote-5' href='#footnote-link-5' >[5] </a>
    <FOOTNOTE>
    In one-sided pattern matching,
    all the equations that contain pattern variables are explicit and already
    solved for the unknown (the pattern variable).
    </FOOTNOTE></div>
    
    
    <div class='footnote'>
      <a class='footnote-number' id='footnote-6' href='#footnote-link-6' >[6] </a>
    <FOOTNOTE>
    Another way to think of unification is
    that it generates the most general pattern that is a specialization of the
    two input patterns.
    
      <span style="color:green">
	That is, the unification of
	<kbd>(?x a)</kbd>
      </span>
      <span style="color:blue">
	This means that the unification of
	<kbd>list($x, "a")</kbd>
      </span>
    
    and
    
      <span style="color:green"><kbd>((b ?y) ?z)</kbd></span>
      <span style="color:blue">
	<kbd>list(list("b", $y), $z)</kbd>
      </span>
    
    is
    
      <span style="color:green"><kbd>((b ?y) a)</kbd>,</span>
      <span style="color:blue"><kbd>list(list("b", $y), "a")</kbd>
      </span>
    
    and
    
      <span style="color:blue">
	that
      </span>
    
    the unification of
    
      <span style="color:green"><kbd>(?x a ?y)</kbd></span>
      <span style="color:blue"><kbd>list($x, "a", $y)</kbd>
      </span>
    
    and
    
      <span style="color:green"><kbd>(?y ?z a)</kbd>,</span>
      <span style="color:blue"><kbd>list($y, $z, "a")</kbd>,
      </span>
    
    discussed above, is
    
      <span style="color:green"><kbd>(a a a)</kbd>.</span>
      <span style="color:blue"><kbd>list("a", "a", "a")</kbd>.
      </span>
    
    For our implementation, it is more convenient to think of the result
    of unification as a frame rather than a pattern.
    </FOOTNOTE></div>
    
    
    <div class='footnote'>
      <a class='footnote-number' id='footnote-7' href='#footnote-link-7' >[7] </a>
    <FOOTNOTE>
    Since unification is a
      
      
      generalization of matching, we could simplify the system by using the
      unifier to produce both streams.  Treating the easy case with the
      simple matcher, however, illustrates how matching (as opposed to
      full-blown unification) can be useful in its own right.
    </FOOTNOTE></div>
    
    
    <div class='footnote'>
      <a class='footnote-number' id='footnote-8' href='#footnote-link-8' >[8] </a>
    <FOOTNOTE>
    The reason we
    use
    
    
    streams (rather than lists) of frames is that the
    recursive application of rules can generate infinite numbers of values that
    satisfy a query.  The delayed evaluation embodied in streams is crucial
    here: The system will print responses one by one as they are generated,
    regardless of whether there are a finite or infinite number of
    responses.
    </FOOTNOTE></div>
    
    
</div></div>

    <div class='nav'>
  
        <a class='btn btn-secondary btn-nav' href='./4.4.1.html'>&lt; Previous</a>
    
    <div style='flex-grow: 1;'></div>
  
        <a class='btn btn-secondary btn-nav' id='99' href='./4.4.3.html'>Next &gt;</a>
      </div>
    <div class='chapter_sign'>
      4.4.2&nbsp;&nbsp;
    How the Query System Works
  
    </div>
    <script> var chapter_id = 98; </script>
    <script> var chapter_path = "chapters/4.4.2.html"; </script>
    <div class='next-page'></div>
    </div>
    </div> <!-- /.container -->
    </body></html>